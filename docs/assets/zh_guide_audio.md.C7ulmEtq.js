import{_ as A,c as s,o as a,f as i,af as e,ag as n,ah as t,ai as l,aj as p,ak as h}from"./chunks/framework.BG74BkEs.js";const _=JSON.parse('{"title":"音频","description":"","frontmatter":{},"headers":[],"relativePath":"zh/guide/audio.md","filePath":"zh/guide/audio.md","lastUpdated":1698833889000}'),c={name:"zh/guide/audio.md"},d=e+" 1x",o=n+" 1x",r=t+" 1x",k=l+" 1x",g=p+" 1x",B=h+" 1x",m=i('<h1 id="音频" tabindex="-1">音频 <a class="header-anchor vp-link" href="#音频" aria-label="Permalink to &quot;音频&quot;">​</a></h1><p>背景音乐和音效会在本文介绍，语音部分请看<a href="/naninovel-docs/guide/voicing" class="vp-link">语音引导</a> 。</p><p>要添加，编辑和移除影片资源，使用<code>Naninovel -&gt; Resources -&gt; Audio</code>菜单内的配置。你可以使用任何 <a href="https://docs.unity3d.com/Manual/AudioFiles.html" class="vp-link" target="_blank" rel="noreferrer">Unity支持<span class="external-link-icon"> ↗</span></a> 的影片格式。</p><div class="imgit-picture" style="display:flex;" data-imgit-container><picture style="width:100%;"><source srcset="'+d+'" type="image/avif"><source srcset="'+o+`"><img data-imgit-loadable alt="" width="720" height="317" loading="lazy" decoding="async"></picture><picture class="imgit-cover" style="width:100%;margin-left:-100%;"><source srcset="data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUEAAAGobWV0YQAAAAAAAAAvaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAFBpY3R1cmVIYW5kbGVyAAAAAA5waXRtAAAAAAABAAAALGlsb2MAAAAARAAAAgABAAAAAQAAAdAAAABHAAIAAAABAAACFwAAABMAAABCaWluZgAAAAAAAgAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAGmluZmUCAAAAAAIAAGF2MDFBbHBoYQAAAAAaaXJlZgAAAAAAAAAOYXV4bAACAAEAAQAAANdpcHJwAAAAsWlwY28AAAAUaXNwZQAAAAAAAAAkAAAAEAAAABBwaXhpAAAAAAMICAgAAAAMYXYxQ4EgAAAAAAATY29scm5jbHgAAgACAACAAAAAFGlzcGUAAAAAAAAAJAAAABAAAAAOcGl4aQAAAAABCAAAAAxhdjFDgQAcAAAAADhhdXhDAAAAAHVybjptcGVnOm1wZWdCOmNpY3A6c3lzdGVtczphdXhpbGlhcnk6YWxwaGEAAAAAHmlwbWEAAAAAAAAAAgABBAECgwQAAgQFBocIAAAAYm1kYXQKCDgU4/aQENACMjsVwAAASIEAztOeMbRlUvPIpHD42jO/AerJR4+EB671UTCn8+7U+RsgzxTo9z2RI8xf6dt7zaXT2V76wAoFGBTj9pUyChXAAAEgAAY04OY=" type="image/avif"><img src="//:0" alt="cover" width="720" height="317" decoding="sync"></picture></div><p>在通过编辑器菜单添加多个背景的时候，可能并不方便，在 <code>Resources/Naninovel/Audio</code>目录下直接拖入资源，这样添加也是可以的。他们就会被自动被注册至脚本。你也可以通过子文件夹来管理相应资源。脚本中需要使用(<code>/</code>)调用。比如<code>Resources/Naninovel/Audio/Music/Ambient/Noise002.wav</code>的资源，脚本中的调用为： <code>Music/Ambient/Noise002</code>。</p><p>使用<a href="/naninovel-docs/zh/guide/resource-providers#寻址资源系统" class="vp-link">可寻址资源系统</a> 来手动公开资源也是可以的。公开资源地址和上述相同，但是需要省略&quot;Resources/&quot;部分。比如开放 &quot;MainTheme.wav&quot; 背景音乐，注册地址为<code>Naninovel/Audio/MainTheme</code>。注意，该系统默认不启用你可以通过资源配置菜单的<code>Enable Addressable In Editor</code>属性来启用。</p><div class="warning custom-block"><p class="custom-block-title">WARNING</p><p>未通过资源管理器分配的音频资产将无法在各种编辑器下拉菜单中使用，比如用于角色元素的 <code>Message Sound</code> 的菜单中。</p></div><p>可以使用 <code>Naninovel -&gt; Configuration -&gt; Audio</code> 菜单配置音频表现。有关可用选项的信息，请参阅<a href="/naninovel-docs/zh/guide/configuration#音频" class="vp-link">属性配置</a>。</p><h2 id="背景音乐" tabindex="-1">背景音乐 <a class="header-anchor vp-link" href="#背景音乐" aria-label="Permalink to &quot;背景音乐&quot;">​</a></h2><p>使用 <a href="/zh/api/#bgm" target="_blank"><code>@bgm</code></a> 命令后跟剪辑名称来控制在naninovel脚本中的音乐播放：</p><div class="language-nani vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">nani</span><pre class="shiki shiki-themes theme-light theme-dark vp-code"><code><span class="line"><span style="--shiki-light:#ACB5C6;--shiki-dark:#5D6470;">; Starts playing a music track with the name \`Sanctuary\` in a loop</span></span>
<span class="line"><span style="--shiki-light:#257DC8;--shiki-dark:#6CB2ED;">@bgm</span><span style="--shiki-light:#9250BF;--shiki-dark:#E2BE7F;"> Sanctuary</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#ACB5C6;--shiki-dark:#5D6470;">; Same as above, but fades-in the volume over 10 seconds and plays only once</span></span>
<span class="line"><span style="--shiki-light:#257DC8;--shiki-dark:#6CB2ED;">@bgm</span><span style="--shiki-light:#9250BF;--shiki-dark:#E2BE7F;"> Sanctuary</span><span style="--shiki-light:#C642A5;--shiki-dark:#CD9769;"> fade:</span><span style="--shiki-light:#9250BF;--shiki-dark:#E2BE7F;">10</span><span style="--shiki-light:#C642A5;--shiki-dark:#CD9769;"> loop:</span><span style="--shiki-light:#9250BF;--shiki-dark:#E2BE7F;">false</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#ACB5C6;--shiki-dark:#5D6470;">; Changes volume of all the played music tracks to 50% over 2.5 seconds and makes them play in a loop</span></span>
<span class="line"><span style="--shiki-light:#257DC8;--shiki-dark:#6CB2ED;">@bgm</span><span style="--shiki-light:#C642A5;--shiki-dark:#CD9769;"> volume:</span><span style="--shiki-light:#9250BF;--shiki-dark:#E2BE7F;">0.5</span><span style="--shiki-light:#C642A5;--shiki-dark:#CD9769;"> loop:</span><span style="--shiki-light:#9250BF;--shiki-dark:#E2BE7F;">true</span><span style="--shiki-light:#C642A5;--shiki-dark:#CD9769;"> time:</span><span style="--shiki-light:#9250BF;--shiki-dark:#E2BE7F;">2.5</span></span></code></pre></div><p>音轨默认循环播放。在 <a href="/zh/api/#bgm" target="_blank"><code>@bgm</code></a> 命令后未定义名字时，所有当前播放的音轨都会收到该命令影响。当音轨正在播放时，不会受到影响（不会重头播放），但是个别参数（音量，循环）会被应用。</p><p>使用 <code>intro</code> 参数，可以播放一次性前奏再接其他音轨循环播放，比如：</p><div class="language-nani vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">nani</span><pre class="shiki shiki-themes theme-light theme-dark vp-code"><code><span class="line"><span style="--shiki-light:#ACB5C6;--shiki-dark:#5D6470;">; 播放 \`BattleThemeIntro\` 一次然后立即循环播放 \`BattleThemeMain\` 。</span></span>
<span class="line"><span style="--shiki-light:#257DC8;--shiki-dark:#6CB2ED;">@bgm</span><span style="--shiki-light:#9250BF;--shiki-dark:#E2BE7F;"> BattleThemeMain</span><span style="--shiki-light:#C642A5;--shiki-dark:#CD9769;"> intro:</span><span style="--shiki-light:#9250BF;--shiki-dark:#E2BE7F;">BattleThemeIntro</span></span></code></pre></div><p>要停止播放音乐，使用 <a href="/zh/api/#stopbgm" target="_blank"><code>@stopBgm</code></a> 命令接剪辑名称。如果未指定片段名称，该命令将停止所有当前播放的曲目。</p><div class="language-nani vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">nani</span><pre class="shiki shiki-themes theme-light theme-dark vp-code"><code><span class="line"><span style="--shiki-light:#ACB5C6;--shiki-dark:#5D6470;">; Fades-out the \`Promenade\` music track over 10 seconds and stops the playback</span></span>
<span class="line"><span style="--shiki-light:#257DC8;--shiki-dark:#6CB2ED;">@stopBgm</span><span style="--shiki-light:#9250BF;--shiki-dark:#E2BE7F;"> Promenade</span><span style="--shiki-light:#C642A5;--shiki-dark:#CD9769;"> fade:</span><span style="--shiki-light:#9250BF;--shiki-dark:#E2BE7F;">10</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#ACB5C6;--shiki-dark:#5D6470;">; Stops all the currently played music tracks</span></span>
<span class="line"><span style="--shiki-light:#257DC8;--shiki-dark:#6CB2ED;">@stopBgm</span></span></code></pre></div><h2 id="音效" tabindex="-1">音效 <a class="header-anchor vp-link" href="#音效" aria-label="Permalink to &quot;音效&quot;">​</a></h2><p>使用<a href="/zh/api/#sfx" target="_blank"><code>@sfx</code></a> 和 <a href="/zh/api/#stopsfx" target="_blank"><code>@stopSfx</code></a>命令跟剪辑名称，以在naninovel脚本中控制音效的播放：</p><div class="language-nani vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">nani</span><pre class="shiki shiki-themes theme-light theme-dark vp-code"><code><span class="line"><span style="--shiki-light:#ACB5C6;--shiki-dark:#5D6470;">; 播放 \`Explosion\` 音效一次</span></span>
<span class="line"><span style="--shiki-light:#257DC8;--shiki-dark:#6CB2ED;">@sfx</span><span style="--shiki-light:#9250BF;--shiki-dark:#E2BE7F;"> Explosion</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#ACB5C6;--shiki-dark:#5D6470;">; 循环播放  \`Rain\`  音效</span></span>
<span class="line"><span style="--shiki-light:#257DC8;--shiki-dark:#6CB2ED;">@sfx</span><span style="--shiki-light:#9250BF;--shiki-dark:#E2BE7F;"> Rain</span><span style="--shiki-light:#C642A5;--shiki-dark:#CD9769;"> loop:</span><span style="--shiki-light:#9250BF;--shiki-dark:#E2BE7F;">true</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#ACB5C6;--shiki-dark:#5D6470;">; 2.5秒内调整所有音量到75%，并关闭所有循环播放选项</span></span>
<span class="line"><span style="--shiki-light:#257DC8;--shiki-dark:#6CB2ED;">@sfx</span><span style="--shiki-light:#C642A5;--shiki-dark:#CD9769;"> volume:</span><span style="--shiki-light:#9250BF;--shiki-dark:#E2BE7F;">0.75</span><span style="--shiki-light:#C642A5;--shiki-dark:#CD9769;"> loop:</span><span style="--shiki-light:#9250BF;--shiki-dark:#E2BE7F;">false</span><span style="--shiki-light:#C642A5;--shiki-dark:#CD9769;"> time:</span><span style="--shiki-light:#9250BF;--shiki-dark:#E2BE7F;">2.5</span></span></code></pre></div><p>音效默认不循环播放。在 <a href="/zh/api/#sfx" target="_blank"><code>@sfx</code></a> 命令后未定义名字时，所有当前播放的音轨都会收到该命令影响。当音轨正在播放时，不会受到影响（不会重头播放），但是个别参数（音量，循环）会被应用。</p><p>要停止播放音效（无论是否循环），使用 <a href="/zh/api/#stopsfx" target="_blank"><code>@stopSfx</code></a> 命令接音效名字。当音效名字未定义，该命令会停止当前所有音效播放。</p><div class="language-nani vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">nani</span><pre class="shiki shiki-themes theme-light theme-dark vp-code"><code><span class="line"><span style="--shiki-light:#ACB5C6;--shiki-dark:#5D6470;">; 停止播放 \`Rain\`，15淡出。</span></span>
<span class="line"><span style="--shiki-light:#257DC8;--shiki-dark:#6CB2ED;">@stopSfx</span><span style="--shiki-light:#9250BF;--shiki-dark:#E2BE7F;"> Rain</span><span style="--shiki-light:#C642A5;--shiki-dark:#CD9769;"> fade:</span><span style="--shiki-light:#9250BF;--shiki-dark:#E2BE7F;">15</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#ACB5C6;--shiki-dark:#5D6470;">; 停止所有音效播放。</span></span>
<span class="line"><span style="--shiki-light:#257DC8;--shiki-dark:#6CB2ED;">@stopSfx</span></span></code></pre></div><h2 id="混音器" tabindex="-1">混音器 <a class="header-anchor vp-link" href="#混音器" aria-label="Permalink to &quot;混音器&quot;">​</a></h2><p>Nanonovel使用了<a href="https://docs.unity3d.com/Manual/AudioMixer.html" class="vp-link" target="_blank" rel="noreferrer">混音器<span class="external-link-icon"> ↗</span></a> 来分离背景音乐，音效和语音音轨。</p><div class="imgit-picture" style="display:flex;" data-imgit-container><picture style="width:100%;"><source srcset="`+r+'" type="image/avif"><source srcset="'+k+'"><img data-imgit-loadable alt="" width="628" height="348" loading="lazy" decoding="async"></picture><picture class="imgit-cover" style="width:100%;margin-left:-100%;"><source srcset="data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUEAAAGobWV0YQAAAAAAAAAvaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAFBpY3R1cmVIYW5kbGVyAAAAAA5waXRtAAAAAAABAAAALGlsb2MAAAAARAAAAgABAAAAAQAAAdAAAABiAAIAAAABAAACMgAAABMAAABCaWluZgAAAAAAAgAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAGmluZmUCAAAAAAIAAGF2MDFBbHBoYQAAAAAaaXJlZgAAAAAAAAAOYXV4bAACAAEAAQAAANdpcHJwAAAAsWlwY28AAAAUaXNwZQAAAAAAAAAfAAAAEQAAABBwaXhpAAAAAAMICAgAAAAMYXYxQ4EgAAAAAAATY29scm5jbHgAAgACAACAAAAAFGlzcGUAAAAAAAAAHwAAABEAAAAOcGl4aQAAAAABCAAAAAxhdjFDgQAcAAAAADhhdXhDAAAAAHVybjptcGVnOm1wZWdCOmNpY3A6c3lzdGVtczphdXhpbGlhcnk6YWxwaGEAAAAAHmlwbWEAAAAAAAAAAgABBAECgwQAAgQFBocIAAAAfW1kYXQKCDgRPQaQENACMlYVwAggQgSBBACY+anDITiN9iiwXEUM7hXVjw1pl6fBD4A7QbzHxpfTvh27wen/xyBX8bu2MjY/xEwbu7PBK7VS1xGncPviRtAz0CwAJiLBftLwL66gqAoFGBE9BpUyChXAAAEgAAPHhDo=" type="image/avif"><img src="//:0" alt="cover" width="628" height="348" decoding="sync"></picture></div><p>可以在音频配置菜单中分配自定义混音器，更改用于每个音频通道的组和音量控制处理（公开的参数名称）。如果未分配自定义混音器，将使用默认配置。</p><div class="imgit-picture" style="display:flex;" data-imgit-container><picture style="width:100%;"><source srcset="'+g+'" type="image/avif"><source srcset="'+B+'"><img data-imgit-loadable alt="" width="720" height="380" loading="lazy" decoding="async"></picture><picture class="imgit-cover" style="width:100%;margin-left:-100%;"><source srcset="data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUEAAAGobWV0YQAAAAAAAAAvaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAFBpY3R1cmVIYW5kbGVyAAAAAA5waXRtAAAAAAABAAAALGlsb2MAAAAARAAAAgABAAAAAQAAAdAAAABuAAIAAAABAAACPgAAABQAAABCaWluZgAAAAAAAgAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAGmluZmUCAAAAAAIAAGF2MDFBbHBoYQAAAAAaaXJlZgAAAAAAAAAOYXV4bAACAAEAAQAAANdpcHJwAAAAsWlwY28AAAAUaXNwZQAAAAAAAAAkAAAAEwAAABBwaXhpAAAAAAMICAgAAAAMYXYxQ4EgAAAAAAATY29scm5jbHgAAgACAACAAAAAFGlzcGUAAAAAAAAAJAAAABMAAAAOcGl4aQAAAAABCAAAAAxhdjFDgQAcAAAAADhhdXhDAAAAAHVybjptcGVnOm1wZWdCOmNpY3A6c3lzdGVtczphdXhpbGlhcnk6YWxwaGEAAAAAHmlwbWEAAAAAAAAAAgABBAECgwQAAgQFBocIAAAAim1kYXQKCDgVI5NICGgBMmIVwAww5ASBBQDrlFqO33mmBo3gpI91T/OzKG4fOAORGQo0SV+v6t0QYW6XVmjwgcBaVB6N3DQ9Xp9p/BQHw8KfHkRIEEgiAshGbePwaVXiyrY8g2uAsY7KN2vzifPO8I+0wAoGGBUjk0qAMgoVwAABIAAGNODm" type="image/avif"><img src="//:0" alt="cover" width="720" height="380" decoding="sync"></picture></div><p>要通过自定义混音器组播放音频，使用<a href="/zh/api/#bgm" target="_blank"><code>@bgm</code></a>, <a href="/zh/api/#sfx" target="_blank"><code>@sfx</code></a> 和 <a href="/zh/api/#voice" target="_blank"><code>@voice</code></a> 命令内的 <code>group</code> 参数。</p><div class="language-nani vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">nani</span><pre class="shiki shiki-themes theme-light theme-dark vp-code"><code><span class="line"><span style="--shiki-light:#ACB5C6;--shiki-dark:#5D6470;">; 通过 `Master/Ambient` 混音器组播放`Noise`</span></span>\n<span class="line"><span style="--shiki-light:#257DC8;--shiki-dark:#6CB2ED;">@sfx</span><span style="--shiki-light:#9250BF;--shiki-dark:#E2BE7F;"> Noise</span><span style="--shiki-light:#C642A5;--shiki-dark:#CD9769;"> loop:</span><span style="--shiki-light:#9250BF;--shiki-dark:#E2BE7F;">true</span><span style="--shiki-light:#C642A5;--shiki-dark:#CD9769;"> group:</span><span style="--shiki-light:#9250BF;--shiki-dark:#E2BE7F;">Master/Ambient</span></span>\n<span class="line"></span>\n<span class="line"><span style="--shiki-light:#ACB5C6;--shiki-dark:#5D6470;">; 通过 `Master/Reverb` 混音器组播放 `ScaryVoice`</span></span>\n<span class="line"><span style="--shiki-light:#257DC8;--shiki-dark:#6CB2ED;">@voice</span><span style="--shiki-light:#9250BF;--shiki-dark:#E2BE7F;"> ScaryVoice</span><span style="--shiki-light:#C642A5;--shiki-dark:#CD9769;"> group:</span><span style="--shiki-light:#9250BF;--shiki-dark:#E2BE7F;">Master/Reverb</span></span></code></pre></div><p>组别是通过 <code>FindMatchingGroups(groupPath)</code> 方法来检索当前的注册混音器。参考<a href="https://docs.unity3d.com/ScriptReference/Audio.AudioMixer.FindMatchingGroups" class="vp-link" target="_blank" rel="noreferrer">Unity文档<span class="external-link-icon"> ↗</span></a> 获取更多关于混音器组路径的说明。如果提供路径下有多个组别，会使用第一个来播放音频。</p><p>在 C# 脚本中，当前使用的混音器通过<a href="/naninovel-docs/zh/guide/engine-services" class="vp-link">引擎服务</a> 的<code>IAudioManager</code> 来获取：</p><div class="language-nani vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">nani</span><pre class="shiki shiki-themes theme-light theme-dark vp-code"><code><span class="line"><span style="--shiki-light:#4B5871;--shiki-dark:#ACB2BE;">var audioManager = Engine.GetService&lt;IAudioManager&gt;();</span></span>\n<span class="line"><span style="--shiki-light:#4B5871;--shiki-dark:#ACB2BE;">var audioMixer = audioManager.AudioMixer;</span></span></code></pre></div>',32),C=[m];function u(y,v,b,E,f,D){return a(),s("div",null,C)}const w=A(c,[["render",u]]);export{_ as __pageData,w as default};
