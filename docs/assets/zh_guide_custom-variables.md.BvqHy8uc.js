import{_ as A,c as s,o as a,f as i,cb as e,cc as t,cd as n,ce as l,cf as h,cg as p}from"./chunks/framework.BG74BkEs.js";const _=JSON.parse('{"title":"自定义变量","description":"","frontmatter":{},"headers":[],"relativePath":"zh/guide/custom-variables.md","filePath":"zh/guide/custom-variables.md","lastUpdated":1698833889000}'),c={name:"zh/guide/custom-variables.md"},d=e+" 1x",o=t+" 1x",r=n+" 1x",k=l+" 1x",g=h+" 1x",B=p+" 1x",m=i(`<h1 id="自定义变量" tabindex="-1">自定义变量 <a class="header-anchor vp-link" href="#自定义变量" aria-label="Permalink to &quot;自定义变量&quot;">​</a></h1><p>自定义变量特性允许用户创建用户指定的变量，使用他们来驱动特定条件下的Naninovel脚本或其他系统执行。比如，自定义变量可以用于选择多个Naninovel脚本中的某一个执行（预设路线），基于用户之前的选择。另一个频繁使用的场景，玩家状态画面（比如，分数，金钱，资源等），基于玩家的游戏中的选择执行操作。</p><p>自定义变量可以自己创建，定制并用于Naninovel脚本中的 <a href="/zh/api/#set" target="_blank"><code>@set</code></a> 和 <a href="/zh/api/#if" target="_blank"><code>@if</code></a> 命令，及C#脚本中的<code>ICustomVariableManager</code> <a href="/naninovel-docs/zh/guide/engine-services" class="vp-link">引擎服务</a> 。</p><p>比如，以下脚本命令将会根据选择为自定义变量 <code>score</code> 赋予不同值：</p><div class="language-nani vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">nani</span><pre class="shiki shiki-themes theme-light theme-dark vp-code"><code><span class="line"><span style="--shiki-light:#257DC8;--shiki-dark:#6CB2ED;">@choice</span><span style="--shiki-light:#9250BF;--shiki-dark:#E2BE7F;"> &quot;I&#39;m humble, one is enough...&quot;</span><span style="--shiki-light:#C642A5;--shiki-dark:#CD9769;"> set:</span><span style="--shiki-light:#9250BF;--shiki-dark:#E2BE7F;">score=1</span></span>
<span class="line"><span style="--shiki-light:#257DC8;--shiki-dark:#6CB2ED;">@choice</span><span style="--shiki-light:#9250BF;--shiki-dark:#E2BE7F;"> &quot;Two, please.&quot;</span><span style="--shiki-light:#C642A5;--shiki-dark:#CD9769;"> set:</span><span style="--shiki-light:#9250BF;--shiki-dark:#E2BE7F;">score=2</span></span>
<span class="line"><span style="--shiki-light:#257DC8;--shiki-dark:#6CB2ED;">@choice</span><span style="--shiki-light:#9250BF;--shiki-dark:#E2BE7F;"> &quot;I&#39;ll take your entire stock!&quot;</span><span style="--shiki-light:#C642A5;--shiki-dark:#CD9769;"> set:</span><span style="--shiki-light:#9250BF;--shiki-dark:#E2BE7F;">score=999</span></span></code></pre></div><p>以下脚本将会根据 <code>score</code> 值决定脚本执行路线：</p><div class="language-nani vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">nani</span><pre class="shiki shiki-themes theme-light theme-dark vp-code"><code><span class="line"><span style="--shiki-light:#257DC8;--shiki-dark:#6CB2ED;">@goto</span><span style="--shiki-light:#9250BF;--shiki-dark:#E2BE7F;"> MainRoute</span><span style="--shiki-light:#C642A5;--shiki-dark:#CD9769;"> if:</span><span style="--shiki-light:#9250BF;--shiki-dark:#E2BE7F;">&quot;score &gt; 1 &amp;&amp; score &lt;= 900&quot;</span></span>
<span class="line"><span style="--shiki-light:#257DC8;--shiki-dark:#6CB2ED;">@goto</span><span style="--shiki-light:#9250BF;--shiki-dark:#E2BE7F;"> BadEnd</span><span style="--shiki-light:#C642A5;--shiki-dark:#CD9769;"> if:</span><span style="--shiki-light:#9250BF;--shiki-dark:#E2BE7F;">score&gt;900</span></span></code></pre></div><p>察看API参考部分获取更多关于 <a href="/zh/api/#set" target="_blank"><code>@set</code></a> 和 <a href="/zh/api/#if" target="_blank"><code>@if</code></a> 命令的示例。</p><p>所有自定义变量都随游戏自动保存。默认情况下，变量存储于<strong>局部范围</strong>中。意味着，在游戏中你注册了某些变量值后，玩家重新开始新游戏或加载了其他栏位的游戏后，该值会丢失。大多数变量适用于此情况。如果，你希望将该变量存储于 <strong>全局范围</strong> ，在其变量名加上 <code>G_</code> 或 <code>g_</code> ，比如<code>G_FinishedMainRoute</code> 或 <code>g_total_score</code>。全局变量可以用于表明部分元信息或总信息，比如，玩家完成某些路线的次数，或所有路线中的总分数。</p><p>在配置菜单的 &quot;Custom Variables&quot; 中，你可以为自定义变量（全局和局部范围）预先设置初始值。</p><div class="imgit-picture" style="display:flex;" data-imgit-container><picture style="width:100%;"><source srcset="`+d+'" type="image/avif"><source srcset="'+o+`"><img data-imgit-loadable alt="" width="720" height="355" loading="lazy" decoding="async"></picture><picture class="imgit-cover" style="width:100%;margin-left:-100%;"><source srcset="data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUEAAAGobWV0YQAAAAAAAAAvaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAFBpY3R1cmVIYW5kbGVyAAAAAA5waXRtAAAAAAABAAAALGlsb2MAAAAARAAAAgABAAAAAQAAAdAAAABgAAIAAAABAAACMAAAABQAAABCaWluZgAAAAAAAgAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAGmluZmUCAAAAAAIAAGF2MDFBbHBoYQAAAAAaaXJlZgAAAAAAAAAOYXV4bAACAAEAAQAAANdpcHJwAAAAsWlwY28AAAAUaXNwZQAAAAAAAAAkAAAAEgAAABBwaXhpAAAAAAMICAgAAAAMYXYxQ4EgAAAAAAATY29scm5jbHgAAgACAACAAAAAFGlzcGUAAAAAAAAAJAAAABIAAAAOcGl4aQAAAAABCAAAAAxhdjFDgQAcAAAAADhhdXhDAAAAAHVybjptcGVnOm1wZWdCOmNpY3A6c3lzdGVtczphdXhpbGlhcnk6YWxwaGEAAAAAHmlwbWEAAAAAAAAAAgABBAECgwQAAgQFBocIAAAAfG1kYXQKCDgVI4tICGgBMlQVwAIIYYSBBADrlGfne39gWsi/RF/zflZYNGFKIS10j4Wl61z+l1sAQ4MfOc3Eh7nNRUKaWZEdQaFbEi5nN11DXvnfos846sdCN6D+23vk+AxTl1AKBhgVI4tKgDIKFcAAASAABjTg5g==" type="image/avif"><img src="//:0" alt="cover" width="720" height="355" decoding="sync"></picture></div><p>全局预定义值将会随第一个应用启动时初始化，本地变量会在每次状态重置时初始化。请注意，菜单中的value字段需要有效的脚本表达式，而不是原始值字符串。</p><h2 id="注入变量" tabindex="-1">注入变量 <a class="header-anchor vp-link" href="#注入变量" aria-label="Permalink to &quot;注入变量&quot;">​</a></h2><p>可以使用花括号将自定义变量注入（内联）到naninovel脚本参数值。</p><p>以下脚本将显示一个输入字段UI，用户可以在其中输入任意文本。提交后，输入的文本将分配给指定的自定义变量。</p><div class="language-nani vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">nani</span><pre class="shiki shiki-themes theme-light theme-dark vp-code"><code><span class="line"><span style="--shiki-light:#ACB5C6;--shiki-dark:#5D6470;">; 允许玩家输入任意文本，并绑定到 \`name\` 自定义变量。</span></span>
<span class="line"><span style="--shiki-light:#257DC8;--shiki-dark:#6CB2ED;">@input</span><span style="--shiki-light:#9250BF;--shiki-dark:#E2BE7F;"> name</span><span style="--shiki-light:#C642A5;--shiki-dark:#CD9769;"> summary:</span><span style="--shiki-light:#9250BF;--shiki-dark:#E2BE7F;">&quot;Choose your name.&quot;</span></span>
<span class="line"><span style="--shiki-light:#ACB5C6;--shiki-dark:#5D6470;">; 停止命令，挂起脚本直到玩家提交输入值。</span></span>
<span class="line"><span style="--shiki-light:#257DC8;--shiki-dark:#6CB2ED;">@stop</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#ACB5C6;--shiki-dark:#5D6470;">; 之后你就可以Naninovel脚本中注入该 \`name\` 变量值。</span></span>
<span class="line"><span style="--shiki-light:#9250BF;--shiki-dark:#E2BE7F;">Archibald:</span><span style="--shiki-light:#4B5871;--shiki-dark:#ACB2BE;"> Greetings, </span><span style="--shiki-light:#3ABFB3;--shiki-dark:#62B8C1;">{name}</span><span style="--shiki-light:#4B5871;--shiki-dark:#ACB2BE;">!</span></span>
<span class="line"><span style="--shiki-light:#9250BF;--shiki-dark:#E2BE7F;">{name}:</span><span style="--shiki-light:#4B5871;--shiki-dark:#ACB2BE;"> Yo!</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#ACB5C6;--shiki-dark:#5D6470;">; ...或在set命令的条件表达式中使用。</span></span>
<span class="line"><span style="--shiki-light:#257DC8;--shiki-dark:#6CB2ED;">@set</span><span style="--shiki-light:#9250BF;--shiki-dark:#E2BE7F;"> score=score+1</span><span style="--shiki-light:#C642A5;--shiki-dark:#CD9769;"> if:</span><span style="--shiki-light:#9250BF;--shiki-dark:#E2BE7F;">name==&quot;Felix&quot;</span></span></code></pre></div><p>只要类型允许，就可以将自定义变量注入任何参数值。例如，不能将字符串（文本）分配给整数（数字）参数。</p><div class="language-nani vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">nani</span><pre class="shiki shiki-themes theme-light theme-dark vp-code"><code><span class="line"><span style="--shiki-light:#257DC8;--shiki-dark:#6CB2ED;">@set</span><span style="--shiki-light:#9250BF;--shiki-dark:#E2BE7F;"> PlayerName=&quot;Felix&quot;;PlayerYPosition=0.1;PlayerTint=&quot;lightblue&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#ACB5C6;--shiki-dark:#5D6470;">; 由于 \`PlayerTint\` 值不是数字，所以会报错。</span></span>
<span class="line"><span style="--shiki-light:#257DC8;--shiki-dark:#6CB2ED;">@char</span><span style="--shiki-light:#3ABFB3;--shiki-dark:#62B8C1;"> {PlayerName}</span><span style="--shiki-light:#C642A5;--shiki-dark:#CD9769;"> pos:</span><span style="--shiki-light:#9250BF;--shiki-dark:#E2BE7F;">50,</span><span style="--shiki-light:#3ABFB3;--shiki-dark:#62B8C1;">{PlayerTint}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#ACB5C6;--shiki-dark:#5D6470;">; ...这句会正常执行。</span></span>
<span class="line"><span style="--shiki-light:#257DC8;--shiki-dark:#6CB2ED;">@char</span><span style="--shiki-light:#3ABFB3;--shiki-dark:#62B8C1;"> {PlayerName}</span><span style="--shiki-light:#C642A5;--shiki-dark:#CD9769;"> pos:</span><span style="--shiki-light:#9250BF;--shiki-dark:#E2BE7F;">50,</span><span style="--shiki-light:#3ABFB3;--shiki-dark:#62B8C1;">{PlayerYPosition}</span><span style="--shiki-light:#C642A5;--shiki-dark:#CD9769;"> tint:</span><span style="--shiki-light:#3ABFB3;--shiki-dark:#62B8C1;">{PlayerTint}</span></span></code></pre></div><h2 id="变量触发器" tabindex="-1">变量触发器 <a class="header-anchor vp-link" href="#变量触发器" aria-label="Permalink to &quot;变量触发器&quot;">​</a></h2><p>在构建 <a href="/naninovel-docs/zh/guide/user-interface#UI自定义" class="vp-link">自定义UI</a> 或其他系统时，可能希望在变量值更改时侦听（反应）事件。比如创建，角色状态界面是，你想让文本跟随变量改变。使用条件判断实现应该会用到C#脚本，你也可以通过 <code>Custom Variable Trigger</code> 组件使用达到效果。当给定名字的变量值改变时，该组件会调用Unity事件。你可以将事件和合适命令绑定，比如更新文本值。</p><div class="imgit-picture" style="display:flex;" data-imgit-container><picture style="width:100%;"><source srcset="`+r+'" type="image/avif"><source srcset="'+k+'"><img data-imgit-loadable alt="" width="503" height="275" loading="lazy" decoding="async"></picture><picture class="imgit-cover" style="width:100%;margin-left:-100%;"><source srcset="data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUEAAAGobWV0YQAAAAAAAAAvaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAFBpY3R1cmVIYW5kbGVyAAAAAA5waXRtAAAAAAABAAAALGlsb2MAAAAARAAAAgABAAAAAQAAAdAAAAA8AAIAAAABAAACDAAAABMAAABCaWluZgAAAAAAAgAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAGmluZmUCAAAAAAIAAGF2MDFBbHBoYQAAAAAaaXJlZgAAAAAAAAAOYXV4bAACAAEAAQAAANdpcHJwAAAAsWlwY28AAAAUaXNwZQAAAAAAAAAZAAAADgAAABBwaXhpAAAAAAMICAgAAAAMYXYxQ4EgAAAAAAATY29scm5jbHgAAgACAACAAAAAFGlzcGUAAAAAAAAAGQAAAA4AAAAOcGl4aQAAAAABCAAAAAxhdjFDgQAcAAAAADhhdXhDAAAAAHVybjptcGVnOm1wZWdCOmNpY3A6c3lzdGVtczphdXhpbGlhcnk6YWxwaGEAAAAAHmlwbWEAAAAAAAAAAgABBAECgwQAAgQFBocIAAAAV21kYXQKCDgQ8a0gIaAEMjAVwAQQQQSBBADFYcuko37z8OZzwxJDr0pO8dZbAzxHn8YTuhel+51cE/f3WN0Tu9gKBRgQ8a0qMgoVwAABIAACaw7h" type="image/avif"><img src="//:0" alt="cover" width="503" height="275" decoding="sync"></picture></div><h2 id="变量debug" tabindex="-1">变量debug <a class="header-anchor vp-link" href="#变量debug" aria-label="Permalink to &quot;变量debug&quot;">​</a></h2><p>在游戏运行时，可以基于debug的目的查看和修改所有已有变量值。</p><p>打开<a href="/naninovel-docs/zh/guide/development-console" class="vp-link">开发控制台</a> ，输入命令，打开 <code>var</code> 变量编辑窗口。</p><div class="imgit-picture" style="display:flex;" data-imgit-container><picture style="width:100%;"><source srcset="'+g+'" type="image/avif"><source srcset="'+B+'"><img data-imgit-loadable alt="" width="720" height="405" loading="lazy" decoding="async"></picture><picture class="imgit-cover" style="width:100%;margin-left:-100%;"><source srcset="data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUEAAAGobWV0YQAAAAAAAAAvaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAFBpY3R1cmVIYW5kbGVyAAAAAA5waXRtAAAAAAABAAAALGlsb2MAAAAARAAAAgABAAAAAQAAAdAAAACzAAIAAAABAAACgwAAABQAAABCaWluZgAAAAAAAgAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAGmluZmUCAAAAAAIAAGF2MDFBbHBoYQAAAAAaaXJlZgAAAAAAAAAOYXV4bAACAAEAAQAAANdpcHJwAAAAsWlwY28AAAAUaXNwZQAAAAAAAAAkAAAAFAAAABBwaXhpAAAAAAMICAgAAAAMYXYxQ4EgAAAAAAATY29scm5jbHgAAgACAACAAAAAFGlzcGUAAAAAAAAAJAAAABQAAAAOcGl4aQAAAAABCAAAAAxhdjFDgQAcAAAAADhhdXhDAAAAAHVybjptcGVnOm1wZWdCOmNpY3A6c3lzdGVtczphdXhpbGlhcnk6YWxwaGEAAAAAHmlwbWEAAAAAAAAAAgABBAECgwQAAgQFBocIAAAAz21kYXQKCDgVI5tICGgBMqYBFcAAAEgQUMaQM4aJjtmCHMdFNlls0VNwGzI3LEXenmVNGNN/5u1khHoi3tzrWcz0dG3ONWZHNO+JGdvL4CkDmzy+c8enoY2+yyCzT3z5kuOHCzMCsUXYGYrmpt2svCJ6QcjqAX1bdd0DC8UzJmDNrIyfxH+sA9AY8adLA9/lkime5h53r8Srbsr53xj/ZyX1CLXx42D/VsdGLtR484WIYoG/QjX3oAoGGBUjm0qAMgoVwAABIAAGNODm" type="image/avif"><img src="//:0" alt="cover" width="720" height="405" decoding="sync"></picture></div><p>当改变列表中的值后，“set”按钮会出现，点击后应用该修改。</p><p>如果游戏运行中变量值改变，变量列表会自动更新对应值。</p>',27),C=[m];function y(u,b,E,F,v,D){return a(),s("div",null,C)}const Q=A(c,[["render",y]]);export{_ as __pageData,Q as default};
