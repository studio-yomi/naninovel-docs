import{_ as A,c as s,o as a,f as i,dq as e,dr as t,ds as n,dt as l,du as p,dv as h,dw as d,dx as c}from"./chunks/framework.BG74BkEs.js";const Y=JSON.parse('{"title":"Управляемый текст","description":"","frontmatter":{},"headers":[],"relativePath":"ru/guide/managed-text.md","filePath":"ru/guide/managed-text.md","lastUpdated":1698833889000}'),o={name:"ru/guide/managed-text.md"},g=e+" 1x",r=t+" 1x",k=n+" 1x",m=l+" 1x",u=p+" 1x",E=h+" 1x",y=d+" 1x",B=c+" 1x",b=i('<h1 id="управляемыи-текст" tabindex="-1">Управляемый текст <a class="header-anchor vp-link" href="#управляемыи-текст" aria-label="Permalink to &quot;Управляемый текст&quot;">​</a></h1><p>Функция управляемого текста позволяет управлять (с помощью замены) различными текстовыми элементами, используемыми в Naninovel, такими как UI в игре и именами персонажей, используя локализуемые документы.</p><p>Для создания управляемого текстового документа, используйте инструмент для управляемого текста, доступный через контекстное меню <code>Naninovel -&gt; Tools -&gt; Managed Text</code>.</p><div class="imgit-picture" style="display:flex;" data-imgit-container><picture style="width:100%;"><source srcset="'+g+'" type="image/avif"><source srcset="'+r+'"><img data-imgit-loadable alt="Инструмент для управляемого текста" width="499" height="163" loading="lazy" decoding="async"></picture><picture class="imgit-cover" style="width:100%;margin-left:-100%;"><source srcset="data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUEAAAGobWV0YQAAAAAAAAAvaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAFBpY3R1cmVIYW5kbGVyAAAAAA5waXRtAAAAAAABAAAALGlsb2MAAAAARAAAAgABAAAAAQAAAdAAAABLAAIAAAABAAACGwAAABMAAABCaWluZgAAAAAAAgAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAGmluZmUCAAAAAAIAAGF2MDFBbHBoYQAAAAAaaXJlZgAAAAAAAAAOYXV4bAACAAEAAQAAANdpcHJwAAAAsWlwY28AAAAUaXNwZQAAAAAAAAAYAAAACAAAABBwaXhpAAAAAAMICAgAAAAMYXYxQ4EgAAAAAAATY29scm5jbHgAAgACAACAAAAAFGlzcGUAAAAAAAAAGAAAAAgAAAAOcGl4aQAAAAABCAAAAAxhdjFDgQAcAAAAADhhdXhDAAAAAHVybjptcGVnOm1wZWdCOmNpY3A6c3lzdGVtczphdXhpbGlhcnk6YWxwaGEAAAAAHmlwbWEAAAAAAAAAAgABBAECgwQAAgQFBocIAAAAZm1kYXQKCDgQr9pAQ0AIMj8VwBBAgQSFRQDNsBQAeWv27kK91GKWfY0mPSeQXoG5DLyCaT/V6g8gKDxItqyWXJb4hvxzw0tTUop5JUcQVMIKBRgQr9pUMgoVwAABIAACaw7h" type="image/avif"><img src="//:0" alt="cover" width="499" height="163" decoding="sync"></picture></div><p>Используя кнопку &quot;Select&quot;, выберите путь для хранения управляемых текстовых документов (по умолчанию это <code>Resources/Naninovel/Text</code>) и нажмите кнопку &quot;Generate&quot; для создания документов.</p><p>Вы также можете создать пользовательский управляемый текстовый документ с помощью контекстного меню ассета <code>Create -&gt; Naninovel -&gt; Managed Text</code>.</p><p>Каждая строка в управляемом текстовом документе представляет собой выражение в следующем формате: <em>Path</em>: <em>Value</em>, где <em>Path</em> – путь к текстовой переменной, а <em>Value</em> – значение этой переменной. Например, вот изначальное содержимое документа &quot;DefaultUI&quot;, который содержит записи для встроенного UI:</p><div class="imgit-picture" style="display:flex;" data-imgit-container><picture style="width:100%;"><source srcset="'+k+'" type="image/avif"><source srcset="'+m+'"><img data-imgit-loadable alt="Управляемый текстовый документ" width="362" height="163" loading="lazy" decoding="async"></picture><picture class="imgit-cover" style="width:100%;margin-left:-100%;"><source srcset="data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUEAAAGobWV0YQAAAAAAAAAvaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAFBpY3R1cmVIYW5kbGVyAAAAAA5waXRtAAAAAAABAAAALGlsb2MAAAAARAAAAgABAAAAAQAAAdAAAABFAAIAAAABAAACFQAAABMAAABCaWluZgAAAAAAAgAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAGmluZmUCAAAAAAIAAGF2MDFBbHBoYQAAAAAaaXJlZgAAAAAAAAAOYXV4bAACAAEAAQAAANdpcHJwAAAAsWlwY28AAAAUaXNwZQAAAAAAAAASAAAACAAAABBwaXhpAAAAAAMICAgAAAAMYXYxQ4EgAAAAAAATY29scm5jbHgAAgACAACAAAAAFGlzcGUAAAAAAAAAEgAAAAgAAAAOcGl4aQAAAAABCAAAAAxhdjFDgQAcAAAAADhhdXhDAAAAAHVybjptcGVnOm1wZWdCOmNpY3A6c3lzdGVtczphdXhpbGlhcnk6YWxwaGEAAAAAHmlwbWEAAAAAAAAAAgABBAECgwQAAgQFBocIAAAAYG1kYXQKCDgQo9pAQ0AIMjkVwAMMAASEBQDwXKhSOkb8XyE+u62X9yEvzGK0CywpNegYOP1WbLsKinWaYKf346z8K+z/kbInKGIKBRgQo9pUMgoVwAABIAACaw7h" type="image/avif"><img src="//:0" alt="cover" width="362" height="163" decoding="sync"></picture></div><p>Вы можете изменить значения, и эти изменения будут применены при следующем запуске.</p><p>Включение свойства <code>Delete Unused</code> приведет к удалению записей в управляемых текстовых документах, на которые нет прямых ссылок ни через компоненты <code>ManagedTextProvider</code>, ни через атрибуты <code>ManagedText</code> в исходном коде (подробнее об этом ниже).</p><h2 id="проваидер-управляемого-текста" tabindex="-1">Провайдер управляемого текста <a class="header-anchor vp-link" href="#проваидер-управляемого-текста" aria-label="Permalink to &quot;Провайдер управляемого текста&quot;">​</a></h2><p>Возможна привязка произвольного игрового объекта Unity к управляемой текстовой записи без каких-либо скриптов с помощью компонента <code>ManagedTextProvider</code>; добавьте компонент к игровому объекту, укажите категорию (имя документа, который будет содержать запись), ключ (имя записи внутри документа), затем используйте событие <code>OnValueChanged</code> для привязки значения к свойству игрового объекта.</p><p>Ниже приведен пример привязки управляемой текстовой записи, хранящейся в документе &quot;MyCustomDocument&quot;, с ключом &quot;MyCustomText&quot; к компоненту Unity &quot;Text&quot;.</p><div class="imgit-picture" style="display:flex;" data-imgit-container><picture style="width:100%;"><source srcset="'+u+'" type="image/avif"><source srcset="'+E+'"><img data-imgit-loadable alt="" width="497" height="226" loading="lazy" decoding="async"></picture><picture class="imgit-cover" style="width:100%;margin-left:-100%;"><source srcset="data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUEAAAGobWV0YQAAAAAAAAAvaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAFBpY3R1cmVIYW5kbGVyAAAAAA5waXRtAAAAAAABAAAALGlsb2MAAAAARAAAAgABAAAAAQAAAdAAAAA3AAIAAAABAAACBwAAABMAAABCaWluZgAAAAAAAgAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAGmluZmUCAAAAAAIAAGF2MDFBbHBoYQAAAAAaaXJlZgAAAAAAAAAOYXV4bAACAAEAAQAAANdpcHJwAAAAsWlwY28AAAAUaXNwZQAAAAAAAAAYAAAACwAAABBwaXhpAAAAAAMICAgAAAAMYXYxQ4EgAAAAAAATY29scm5jbHgAAgACAACAAAAAFGlzcGUAAAAAAAAAGAAAAAsAAAAOcGl4aQAAAAABCAAAAAxhdjFDgQAcAAAAADhhdXhDAAAAAHVybjptcGVnOm1wZWdCOmNpY3A6c3lzdGVtczphdXhpbGlhcnk6YWxwaGEAAAAAHmlwbWEAAAAAAAAAAgABBAECgwQAAgQFBocIAAAAUm1kYXQKCDgQ700gIaAEMisVwAwwAASEEQDowt9Ng7LYQo44TU9C2gAHhgxfPxwAludEQHplZRZRvfcYCgUYEO9NKjIKFcAAASAAAmsO4Q==" type="image/avif"><img src="//:0" alt="cover" width="497" height="226" decoding="sync"></picture></div><p>Если компонент <code>ManagedTextProvider</code> используется в пользовательском UI, текстовом принтере или обработчике выбора, соответствующие записи будут автоматически сгенерированы при использовании инструмента для управляемого текста (учитывая, что ресурсы назначены в меню конфигурации); в других случаях вам придется добавлять записи вручную.</p><div class="imgit-picture" style="display:flex;" data-imgit-container><picture style="width:100%;"><source srcset="'+y+'" type="image/avif"><source srcset="'+B+`"><img data-imgit-loadable alt="" width="388" height="83" loading="lazy" decoding="async"></picture><picture class="imgit-cover" style="width:100%;margin-left:-100%;"><source srcset="data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUEAAAGobWV0YQAAAAAAAAAvaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAFBpY3R1cmVIYW5kbGVyAAAAAA5waXRtAAAAAAABAAAALGlsb2MAAAAARAAAAgABAAAAAQAAAdAAAAA3AAIAAAABAAACBwAAABMAAABCaWluZgAAAAAAAgAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAGmluZmUCAAAAAAIAAGF2MDFBbHBoYQAAAAAaaXJlZgAAAAAAAAAOYXV4bAACAAEAAQAAANdpcHJwAAAAsWlwY28AAAAUaXNwZQAAAAAAAAATAAAABAAAABBwaXhpAAAAAAMICAgAAAAMYXYxQ4EgAAAAAAATY29scm5jbHgAAgACAACAAAAAFGlzcGUAAAAAAAAAEwAAAAQAAAAOcGl4aQAAAAABCAAAAAxhdjFDgQAcAAAAADhhdXhDAAAAAHVybjptcGVnOm1wZWdCOmNpY3A6c3lzdGVtczphdXhpbGlhcnk6YWxwaGEAAAAAHmlwbWEAAAAAAAAAAgABBAECgwQAAgQFBocIAAAAUm1kYXQKCDgQZbSAhoAQMisVwAAASIBQ+QYyvqep0BDY4DRioJ7/yG/tVbujPBnBNVJX5IhT6hcXmefyCgUYEGW0qDIKFcAAASAAAmsO4Q==" type="image/avif"><img src="//:0" alt="cover" width="388" height="83" decoding="sync"></picture></div><h2 id="переменные-управляемого-текста" tabindex="-1">Переменные управляемого текста <a class="header-anchor vp-link" href="#переменные-управляемого-текста" aria-label="Permalink to &quot;Переменные управляемого текста&quot;">​</a></h2><p>Также возможно связать управляемые текстовые записи с переменными в исходном коде. Для этого необходимо добавить атрибут <code>ManagedText</code> для статичного строкового поля в скрипте на C#. Его значение будет перезаписано значением, указанным в управляемом текстовом документе при инициализации движка.</p><p>Ниже приведен пример использования управляемой текстовой переменной для локализации текстовой метки в скрипте C#.</p><div class="language-csharp vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">csharp</span><pre class="shiki shiki-themes theme-light theme-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">using</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Naninovel</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">using</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> UnityEngine</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">UI</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Наследуем наш класс от текстового компонента Unity, так что мы можем использовать его таким же образом.</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">public</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> CustomLabel</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> : </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Text</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // Значение управляемой текстовой записи &quot;CustomLabel.LabelText&quot; будет присвоено</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // приведенной ниже переменной при инициализации движка и обновлении при изменении локали.</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    [</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ManagedText</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;MyCustomUI&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)] </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// &quot;MyCustomUI&quot; – имя управляемого текстового документа, в котором будет храниться запись.</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    public</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> static</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> string</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> LabelText</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;Default Value&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">; </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// &quot;Default Value&quot; – исходное значение записи.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    protected</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> override</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> void</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Awake</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        base</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Awake</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        text </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> LabelText; </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Присвоить метке текущее значение управляемой текстовой записи.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        // Обновить метку, когда пользователь меняет локаль в процессе выполнения.</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        Engine.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">GetService</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ILocalizationManager</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;().OnLocaleChanged </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> _</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> text </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> LabelText;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><h2 id="текст-сценариев" tabindex="-1">Текст сценариев <a class="header-anchor vp-link" href="#текст-сценариев" aria-label="Permalink to &quot;Текст сценариев&quot;">​</a></h2><p>Можно получать управляемые текстовые значения непосредственно из сценариев Naninovel. Это может быть удобно, когда требуется использовать некоторый текст в выражениях скриптов, и текст должен быть локализуемым.</p><p>Создайте управляемый текстовый документ с именем &quot;Script&quot; и добавьте записи, используя ключи с префиксом <code>T_</code> или <code>t_</code>. Теперь можно ссылаться на значения в выражениях скрипта; например, учитывая следующие записи в управляемом текстовом документе &quot;Script&quot;:</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes theme-light theme-dark vp-code"><code><span class="line"><span>T_Greeting1: Hey!</span></span>
<span class="line"><span>T_Greeting2: Hello!</span></span>
<span class="line"><span>T_Greeting3: Hi!</span></span></code></pre></div><p>— вы можете сослаться на данные значения следующим образом:</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes theme-light theme-dark vp-code"><code><span class="line"><span>@print {Random(T_Greeting1,T_Greeting2,T_Greeting3)}</span></span></code></pre></div><p>Конечно, управляемый текстовый документ &quot;Script&quot; может быть локализован так же, как и другие документы; поэтому, когда пользователь выберет другую локаль, на текст автоматически будет ссылаться соответствующий локализованный документ.</p><h2 id="локализация" tabindex="-1">Локализация <a class="header-anchor vp-link" href="#локализация" aria-label="Permalink to &quot;Локализация&quot;">​</a></h2><p>Процесс локализации управляемого текста похож на процесс локализации сценариев Naninovel:</p><ol><li>Сгенерируйте (создайте, отредактируйте) необходимые управляемые текстовые документы в папке <code>Resources/Naninovel/Text</code>.</li><li>Запустите программу локализации в папке локали (<code>Resources/Naninovel/Localization/{Locale}</code>, где <code>{Locale}</code> – тег целевой локали).</li><li>Документы локализации для исходных управляемых текстовых документов появятся в соответствующей папке локали. Используйте их для добавления или редактирования перевода.</li></ol><p>Чтобы обновить управляемые текстовые документы и их соответствующие аналоги в локалях, сначала запустите утилиту создания управляемого текста в папке <code>Resources/Naninovel/Text</code>, а затем утилиту локализации в папке <code>Resources/Naninovel/Localization/{Locale}</code>. Обе утилиты по умолчанию будут пытаться сохранить все существующие модификации (управляемые текстовые записи и их переводы), так что вам не придется переписывать все с нуля при каждом обновлении.</p><p>См. <a href="/naninovel-docs/ru/guide/localization" class="vp-link">локализацию</a> для дополнительной информации о том, как использовать утилиту локализации.</p><div class="tip custom-block"><p class="custom-block-title">EXAMPLE</p><p>Пример настройки локализации (включая управляемый текст) вы можете найти в <a href="/naninovel-docs/ru/guide/getting-started#demo-project" class="vp-link">демо-проекте</a>. Вы можете использовать его в качестве референса в случае возникновения проблем с настройкой локализации в вашем собственном проекте.</p></div>`,33),C=[b];function v(G,F,w,Q,x,_){return a(),s("div",null,C)}const I=A(o,[["render",v]]);export{Y as __pageData,I as default};
