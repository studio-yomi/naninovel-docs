import{_ as A,c as s,o as a,f as i,cb as e,cc as t,cd as n,ce as l,cf as p,cg as h}from"./chunks/framework.BG74BkEs.js";const _=JSON.parse('{"title":"Пользовательские переменные","description":"","frontmatter":{},"headers":[],"relativePath":"ru/guide/custom-variables.md","filePath":"ru/guide/custom-variables.md","lastUpdated":1698833889000}'),c={name:"ru/guide/custom-variables.md"},d=e+" 1x",o=t+" 1x",r=n+" 1x",k=l+" 1x",g=p+" 1x",B=h+" 1x",m=i(`<h1 id="пользовательские-переменные" tabindex="-1">Пользовательские переменные <a class="header-anchor vp-link" href="#пользовательские-переменные" aria-label="Permalink to &quot;Пользовательские переменные&quot;">​</a></h1><p>Функция пользовательских переменных позволяет создавать специализированные переменные, изменять и использовать их для управления условным выполнением сценариев Naninovel или других систем. Например, пользовательские переменные могут использоваться для выбора одного из нескольких сценариев Naninovel для воспроизведения (руты сценариев), основанных на решениях, принятых игроком в прошлом. Другой часто используемый сценарий – это экран статистики игрока (например, результаты, деньги, ресурсы и т.д.), основанный на выборах, которые игрок совершает на протяжении всей игры.</p><p>Пользовательские переменные могут быть созданы, изменены и использованы в сценариях Naninovel через команды <a href="/ru/api/#set" target="_blank"><code>@set</code></a> и <a href="/ru/api/#if" target="_blank"><code>@if</code></a> команды и в скриптах C# с помощью <a href="/naninovel-docs/ru/guide/engine-services" class="vp-link">сервиса движка</a> <code>ICustomVariableManager</code>.</p><p>Например, следующая команда сценария присвоит пользовательской переменной <code>score</code> значение в зависимости от выбора игрока:</p><div class="language-nani vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">nani</span><pre class="shiki shiki-themes theme-light theme-dark vp-code"><code><span class="line"><span style="--shiki-light:#257DC8;--shiki-dark:#6CB2ED;">@choice</span><span style="--shiki-light:#9250BF;--shiki-dark:#E2BE7F;"> &quot;I&#39;m humble, one is enough...&quot;</span><span style="--shiki-light:#C642A5;--shiki-dark:#CD9769;"> set:</span><span style="--shiki-light:#9250BF;--shiki-dark:#E2BE7F;">score=1</span></span>
<span class="line"><span style="--shiki-light:#257DC8;--shiki-dark:#6CB2ED;">@choice</span><span style="--shiki-light:#9250BF;--shiki-dark:#E2BE7F;"> &quot;Two, please.&quot;</span><span style="--shiki-light:#C642A5;--shiki-dark:#CD9769;"> set:</span><span style="--shiki-light:#9250BF;--shiki-dark:#E2BE7F;">score=2</span></span>
<span class="line"><span style="--shiki-light:#257DC8;--shiki-dark:#6CB2ED;">@choice</span><span style="--shiki-light:#9250BF;--shiki-dark:#E2BE7F;"> &quot;I&#39;ll take your entire stock!&quot;</span><span style="--shiki-light:#C642A5;--shiki-dark:#CD9769;"> set:</span><span style="--shiki-light:#9250BF;--shiki-dark:#E2BE7F;">score=999</span></span></code></pre></div><p>А следующая будет перенаправлять выполнение сценария на основе значения переменной <code>score</code>:</p><div class="language-nani vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">nani</span><pre class="shiki shiki-themes theme-light theme-dark vp-code"><code><span class="line"><span style="--shiki-light:#257DC8;--shiki-dark:#6CB2ED;">@goto</span><span style="--shiki-light:#9250BF;--shiki-dark:#E2BE7F;"> MainRoute</span><span style="--shiki-light:#C642A5;--shiki-dark:#CD9769;"> if:</span><span style="--shiki-light:#9250BF;--shiki-dark:#E2BE7F;">&quot;score &gt; 1 &amp;&amp; score &lt;= 900&quot;</span></span>
<span class="line"><span style="--shiki-light:#257DC8;--shiki-dark:#6CB2ED;">@goto</span><span style="--shiki-light:#9250BF;--shiki-dark:#E2BE7F;"> BadEnd</span><span style="--shiki-light:#C642A5;--shiki-dark:#CD9769;"> if:</span><span style="--shiki-light:#9250BF;--shiki-dark:#E2BE7F;">score&gt;900</span></span></code></pre></div><p>Дополнительные примеры см. в справочнике API по командам <a href="/ru/api/#set" target="_blank"><code>@set</code></a> и <a href="/ru/api/#if" target="_blank"><code>@if</code></a>.</p><p>Все пользовательские переменные автоматически сохраняются вместе с игрой. По умолчанию переменные хранятся в <strong>локальной области</strong>. Это означает, что если вы назначите какую–то переменную в ходе игрового процесса, а после игрок начнет новую игру или загрузит другой сохраненный игровой слот, где эта переменная не была назначена – значение будет потеряно. Это используется для большинства типов переменных. Однако если вы хотите сохранить переменную в <strong>глобальной области</strong>, добавьте к ее имени <code>G_</code> или <code>g_</code>, например: <code>G_FinishedMainRoute</code> или <code>g_total_score</code>. Глобальные переменные могут использоваться для указания некоторой общей информации, например, количества раз, когда игрок закончил какой-то рут, или общего счёта, основанного на всех прохождениях игры.</p><p>Вы можете установить предварительно определенные пользовательские переменные (как глобальные, так и локальные) с начальными значениями в меню конфигурации &quot;Custom Variables&quot;.</p><div class="imgit-picture" style="display:flex;" data-imgit-container><picture style="width:100%;"><source srcset="`+d+'" type="image/avif"><source srcset="'+o+`"><img data-imgit-loadable alt="" width="720" height="355" loading="lazy" decoding="async"></picture><picture class="imgit-cover" style="width:100%;margin-left:-100%;"><source srcset="data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUEAAAGobWV0YQAAAAAAAAAvaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAFBpY3R1cmVIYW5kbGVyAAAAAA5waXRtAAAAAAABAAAALGlsb2MAAAAARAAAAgABAAAAAQAAAdAAAABgAAIAAAABAAACMAAAABQAAABCaWluZgAAAAAAAgAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAGmluZmUCAAAAAAIAAGF2MDFBbHBoYQAAAAAaaXJlZgAAAAAAAAAOYXV4bAACAAEAAQAAANdpcHJwAAAAsWlwY28AAAAUaXNwZQAAAAAAAAAkAAAAEgAAABBwaXhpAAAAAAMICAgAAAAMYXYxQ4EgAAAAAAATY29scm5jbHgAAgACAACAAAAAFGlzcGUAAAAAAAAAJAAAABIAAAAOcGl4aQAAAAABCAAAAAxhdjFDgQAcAAAAADhhdXhDAAAAAHVybjptcGVnOm1wZWdCOmNpY3A6c3lzdGVtczphdXhpbGlhcnk6YWxwaGEAAAAAHmlwbWEAAAAAAAAAAgABBAECgwQAAgQFBocIAAAAfG1kYXQKCDgVI4tICGgBMlQVwAIIYYSBBADrlGfne39gWsi/RF/zflZYNGFKIS10j4Wl61z+l1sAQ4MfOc3Eh7nNRUKaWZEdQaFbEi5nN11DXvnfos846sdCN6D+23vk+AxTl1AKBhgVI4tKgDIKFcAAASAABjTg5g==" type="image/avif"><img src="//:0" alt="cover" width="720" height="355" decoding="sync"></picture></div><p>Глобальные предопределенные переменные инициализируются при первом запуске приложения, в то время как локальные делают это при каждом сбросе состояния. Обратите внимание, что поле значения в меню ожидает допустимое выражение сценария, а не необработанную строку значения.</p><h2 id="внедрение-переменных" tabindex="-1">Внедрение переменных <a class="header-anchor vp-link" href="#внедрение-переменных" aria-label="Permalink to &quot;Внедрение переменных&quot;">​</a></h2><p>Можно внедрить (встроить) пользовательскую переменную в значения параметров сценария Naninovel, используя фигурные скобки.</p><p>Следующий скрипт покажет интерфейс поля ввода, где пользователь сможет ввести произвольный текст. После введения введенный текст будет присвоен указанной пользовательской переменной.</p><div class="language-nani vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">nani</span><pre class="shiki shiki-themes theme-light theme-dark vp-code"><code><span class="line"><span style="--shiki-light:#ACB5C6;--shiki-dark:#5D6470;">; Разрешить пользователю ввести произвольный текст и назначить его пользовательской переменной состояния \`name\`.</span></span>
<span class="line"><span style="--shiki-light:#257DC8;--shiki-dark:#6CB2ED;">@input</span><span style="--shiki-light:#9250BF;--shiki-dark:#E2BE7F;"> name</span><span style="--shiki-light:#C642A5;--shiki-dark:#CD9769;"> summary:</span><span style="--shiki-light:#9250BF;--shiki-dark:#E2BE7F;">&quot;Choose your name.&quot;</span></span>
<span class="line"><span style="--shiki-light:#ACB5C6;--shiki-dark:#5D6470;">; Команда Stop необходима для остановки выполнения скрипта до тех пор, пока пользователь не отправит вводимые данные.</span></span>
<span class="line"><span style="--shiki-light:#257DC8;--shiki-dark:#6CB2ED;">@stop</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#ACB5C6;--shiki-dark:#5D6470;">; Теперь можно ввести назначенную переменную \`name\` в сценарии Naninovel…</span></span>
<span class="line"><span style="--shiki-light:#9250BF;--shiki-dark:#E2BE7F;">Archibald:</span><span style="--shiki-light:#4B5871;--shiki-dark:#ACB2BE;"> Greetings, </span><span style="--shiki-light:#3ABFB3;--shiki-dark:#62B8C1;">{name}</span><span style="--shiki-light:#4B5871;--shiki-dark:#ACB2BE;">!</span></span>
<span class="line"><span style="--shiki-light:#9250BF;--shiki-dark:#E2BE7F;">{name}:</span><span style="--shiki-light:#4B5871;--shiki-dark:#ACB2BE;"> Yo!</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#ACB5C6;--shiki-dark:#5D6470;">; … или используйте её внутри набора и условных выражений.</span></span>
<span class="line"><span style="--shiki-light:#257DC8;--shiki-dark:#6CB2ED;">@set</span><span style="--shiki-light:#9250BF;--shiki-dark:#E2BE7F;"> score=score+1</span><span style="--shiki-light:#C642A5;--shiki-dark:#CD9769;"> if:</span><span style="--shiki-light:#9250BF;--shiki-dark:#E2BE7F;">name==&quot;Felix&quot;</span></span></code></pre></div><p>Вы можете вводить пользовательские переменные в любые значения параметров, если это позволяет тип. Например, вы не можете назначить строку (текст) целочисленному параметру (числу).</p><div class="language-nani vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">nani</span><pre class="shiki shiki-themes theme-light theme-dark vp-code"><code><span class="line"><span style="--shiki-light:#257DC8;--shiki-dark:#6CB2ED;">@set</span><span style="--shiki-light:#9250BF;--shiki-dark:#E2BE7F;"> PlayerName=&quot;Felix&quot;;PlayerYPosition=0.1;PlayerTint=&quot;lightblue&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#ACB5C6;--shiki-dark:#5D6470;">; Следующее выражение вызовет ошибку, так как \`PlayerTint\` не является числом…</span></span>
<span class="line"><span style="--shiki-light:#257DC8;--shiki-dark:#6CB2ED;">@char</span><span style="--shiki-light:#3ABFB3;--shiki-dark:#62B8C1;"> {PlayerName}</span><span style="--shiki-light:#C642A5;--shiki-dark:#CD9769;"> pos:</span><span style="--shiki-light:#9250BF;--shiki-dark:#E2BE7F;">50,</span><span style="--shiki-light:#3ABFB3;--shiki-dark:#62B8C1;">{PlayerTint}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#ACB5C6;--shiki-dark:#5D6470;">; … а это будет выполнено корректно..</span></span>
<span class="line"><span style="--shiki-light:#257DC8;--shiki-dark:#6CB2ED;">@char</span><span style="--shiki-light:#3ABFB3;--shiki-dark:#62B8C1;"> {PlayerName}</span><span style="--shiki-light:#C642A5;--shiki-dark:#CD9769;"> pos:</span><span style="--shiki-light:#9250BF;--shiki-dark:#E2BE7F;">50,</span><span style="--shiki-light:#3ABFB3;--shiki-dark:#62B8C1;">{PlayerYPosition}</span><span style="--shiki-light:#C642A5;--shiki-dark:#CD9769;"> tint:</span><span style="--shiki-light:#3ABFB3;--shiki-dark:#62B8C1;">{PlayerTint}</span></span></code></pre></div><h2 id="переменные-триггеры" tabindex="-1">Переменные триггеры <a class="header-anchor vp-link" href="#переменные-триггеры" aria-label="Permalink to &quot;Переменные триггеры&quot;">​</a></h2><p>При создании <a href="/naninovel-docs/ru/guide/user-interface#кастомизация-UI" class="vp-link">пользовательского интерфейса</a> или других систем вам может потребоваться реагирование событий на изменения значений переменных. Например, при построении экрана статистики персонажей вы хотите, чтобы текст изменялся вслед за переменными. Хотя обычным способом реализации такого поведения было бы использование скрипта C#, вы также можете использовать компонент <code>Custom Variable Trigger</code>. Компонент будет вызывать события Unity при изменении переменной с указанным именем. Вы можете связать совместимые команды с определёнными событиями, такими как обновление текстовых значений.</p><div class="imgit-picture" style="display:flex;" data-imgit-container><picture style="width:100%;"><source srcset="`+r+'" type="image/avif"><source srcset="'+k+'"><img data-imgit-loadable alt="" width="503" height="275" loading="lazy" decoding="async"></picture><picture class="imgit-cover" style="width:100%;margin-left:-100%;"><source srcset="data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUEAAAGobWV0YQAAAAAAAAAvaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAFBpY3R1cmVIYW5kbGVyAAAAAA5waXRtAAAAAAABAAAALGlsb2MAAAAARAAAAgABAAAAAQAAAdAAAAA8AAIAAAABAAACDAAAABMAAABCaWluZgAAAAAAAgAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAGmluZmUCAAAAAAIAAGF2MDFBbHBoYQAAAAAaaXJlZgAAAAAAAAAOYXV4bAACAAEAAQAAANdpcHJwAAAAsWlwY28AAAAUaXNwZQAAAAAAAAAZAAAADgAAABBwaXhpAAAAAAMICAgAAAAMYXYxQ4EgAAAAAAATY29scm5jbHgAAgACAACAAAAAFGlzcGUAAAAAAAAAGQAAAA4AAAAOcGl4aQAAAAABCAAAAAxhdjFDgQAcAAAAADhhdXhDAAAAAHVybjptcGVnOm1wZWdCOmNpY3A6c3lzdGVtczphdXhpbGlhcnk6YWxwaGEAAAAAHmlwbWEAAAAAAAAAAgABBAECgwQAAgQFBocIAAAAV21kYXQKCDgQ8a0gIaAEMjAVwAQQQQSBBADFYcuko37z8OZzwxJDr0pO8dZbAzxHn8YTuhel+51cE/f3WN0Tu9gKBRgQ8a0qMgoVwAABIAACaw7h" type="image/avif"><img src="//:0" alt="cover" width="503" height="275" decoding="sync"></picture></div><h2 id="отладка-переменных" tabindex="-1">Отладка переменных <a class="header-anchor vp-link" href="#отладка-переменных" aria-label="Permalink to &quot;Отладка переменных&quot;">​</a></h2><p>Во время воспроизведения игры можно просматривать все существующие переменные и изменять их значения в целях отладки.</p><p>Откройте <a href="/naninovel-docs/ru/guide/development-console" class="vp-link">консоль разработчика</a> и введите команду <code>var</code>, чтобы открыть окно редактора переменных.</p><div class="imgit-picture" style="display:flex;" data-imgit-container><picture style="width:100%;"><source srcset="'+g+'" type="image/avif"><source srcset="'+B+'"><img data-imgit-loadable alt="" width="720" height="405" loading="lazy" decoding="async"></picture><picture class="imgit-cover" style="width:100%;margin-left:-100%;"><source srcset="data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUEAAAGobWV0YQAAAAAAAAAvaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAFBpY3R1cmVIYW5kbGVyAAAAAA5waXRtAAAAAAABAAAALGlsb2MAAAAARAAAAgABAAAAAQAAAdAAAACzAAIAAAABAAACgwAAABQAAABCaWluZgAAAAAAAgAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAGmluZmUCAAAAAAIAAGF2MDFBbHBoYQAAAAAaaXJlZgAAAAAAAAAOYXV4bAACAAEAAQAAANdpcHJwAAAAsWlwY28AAAAUaXNwZQAAAAAAAAAkAAAAFAAAABBwaXhpAAAAAAMICAgAAAAMYXYxQ4EgAAAAAAATY29scm5jbHgAAgACAACAAAAAFGlzcGUAAAAAAAAAJAAAABQAAAAOcGl4aQAAAAABCAAAAAxhdjFDgQAcAAAAADhhdXhDAAAAAHVybjptcGVnOm1wZWdCOmNpY3A6c3lzdGVtczphdXhpbGlhcnk6YWxwaGEAAAAAHmlwbWEAAAAAAAAAAgABBAECgwQAAgQFBocIAAAAz21kYXQKCDgVI5tICGgBMqYBFcAAAEgQUMaQM4aJjtmCHMdFNlls0VNwGzI3LEXenmVNGNN/5u1khHoi3tzrWcz0dG3ONWZHNO+JGdvL4CkDmzy+c8enoY2+yyCzT3z5kuOHCzMCsUXYGYrmpt2svCJ6QcjqAX1bdd0DC8UzJmDNrIyfxH+sA9AY8adLA9/lkime5h53r8Srbsr53xj/ZyX1CLXx42D/VsdGLtR484WIYoG/QjX3oAoGGBUjm0qAMgoVwAABIAAGNODm" type="image/avif"><img src="//:0" alt="cover" width="720" height="405" decoding="sync"></picture></div><p>При изменении значения переменной в списке появится кнопка &quot;SET&quot;, которую можно нажать, чтобы применить изменения.</p><p>Список переменных автоматически обновляется при изменении пользовательских переменных во время воспроизведения.</p>',27),C=[m];function y(u,E,b,F,v,D){return a(),s("div",null,C)}const Q=A(c,[["render",y]]);export{_ as __pageData,Q as default};
