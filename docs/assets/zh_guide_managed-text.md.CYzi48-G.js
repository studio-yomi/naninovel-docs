import{_ as A,c as s,o as a,f as i,dq as e,dr as t,ds as n,dt as l,du as p,dv as h,dw as d,dx as c}from"./chunks/framework.BG74BkEs.js";const Y=JSON.parse('{"title":"托管文本","description":"","frontmatter":{},"headers":[],"relativePath":"zh/guide/managed-text.md","filePath":"zh/guide/managed-text.md","lastUpdated":1698833889000}'),o={name:"zh/guide/managed-text.md"},g=e+" 1x",r=t+" 1x",k=n+" 1x",m=l+" 1x",E=p+" 1x",y=h+" 1x",u=d+" 1x",B=c+" 1x",C=i('<h1 id="托管文本" tabindex="-1">托管文本 <a class="header-anchor vp-link" href="#托管文本" aria-label="Permalink to &quot;托管文本&quot;">​</a></h1><p>托管文本功能允许管理（替换）整个Naninovel中使用的各种文本元素，例如游戏中的UI和使用本地化文档显示角色名称。</p><p>要生成托管文本文档，通过<code>Naninovel -&gt; Tools -&gt; Managed Text</code> 菜单打开托管文本工具。</p><div class="imgit-picture" style="display:flex;" data-imgit-container><picture style="width:100%;"><source srcset="'+g+'" type="image/avif"><source srcset="'+r+'"><img data-imgit-loadable alt="Managed Text Tool" width="499" height="163" loading="lazy" decoding="async"></picture><picture class="imgit-cover" style="width:100%;margin-left:-100%;"><source srcset="data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUEAAAGobWV0YQAAAAAAAAAvaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAFBpY3R1cmVIYW5kbGVyAAAAAA5waXRtAAAAAAABAAAALGlsb2MAAAAARAAAAgABAAAAAQAAAdAAAABLAAIAAAABAAACGwAAABMAAABCaWluZgAAAAAAAgAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAGmluZmUCAAAAAAIAAGF2MDFBbHBoYQAAAAAaaXJlZgAAAAAAAAAOYXV4bAACAAEAAQAAANdpcHJwAAAAsWlwY28AAAAUaXNwZQAAAAAAAAAYAAAACAAAABBwaXhpAAAAAAMICAgAAAAMYXYxQ4EgAAAAAAATY29scm5jbHgAAgACAACAAAAAFGlzcGUAAAAAAAAAGAAAAAgAAAAOcGl4aQAAAAABCAAAAAxhdjFDgQAcAAAAADhhdXhDAAAAAHVybjptcGVnOm1wZWdCOmNpY3A6c3lzdGVtczphdXhpbGlhcnk6YWxwaGEAAAAAHmlwbWEAAAAAAAAAAgABBAECgwQAAgQFBocIAAAAZm1kYXQKCDgQr9pAQ0AIMj8VwBBAgQSFRQDNsBQAeWv27kK91GKWfY0mPSeQXoG5DLyCaT/V6g8gKDxItqyWXJb4hvxzw0tTUop5JUcQVMIKBRgQr9pUMgoVwAABIAACaw7h" type="image/avif"><img src="//:0" alt="cover" width="499" height="163" decoding="sync"></picture></div><p>使用&quot;Select&quot;（选择）按钮，选择要存储托管文本文件的路径（默认应该为： <code>Resources/Naninovel/Text</code> ），然后点击 &quot;Generate&quot; 生成按钮来创建文件。</p><p>可以通过 <code>Create -&gt; Naninovel -&gt; Managed Text</code> 来创建自定义托管文本文件。</p><p>托管文本文档中的每一行都是以下格式的表达式：Path：Value，其中Path是文本变量的路径，而Value是该变量的值。例如，以下是“ DefaultUI”文档的默认内容，其中包含内置UI的记录：</p><div class="imgit-picture" style="display:flex;" data-imgit-container><picture style="width:100%;"><source srcset="'+k+'" type="image/avif"><source srcset="'+m+'"><img data-imgit-loadable alt="Managed Text Document" width="362" height="163" loading="lazy" decoding="async"></picture><picture class="imgit-cover" style="width:100%;margin-left:-100%;"><source srcset="data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUEAAAGobWV0YQAAAAAAAAAvaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAFBpY3R1cmVIYW5kbGVyAAAAAA5waXRtAAAAAAABAAAALGlsb2MAAAAARAAAAgABAAAAAQAAAdAAAABFAAIAAAABAAACFQAAABMAAABCaWluZgAAAAAAAgAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAGmluZmUCAAAAAAIAAGF2MDFBbHBoYQAAAAAaaXJlZgAAAAAAAAAOYXV4bAACAAEAAQAAANdpcHJwAAAAsWlwY28AAAAUaXNwZQAAAAAAAAASAAAACAAAABBwaXhpAAAAAAMICAgAAAAMYXYxQ4EgAAAAAAATY29scm5jbHgAAgACAACAAAAAFGlzcGUAAAAAAAAAEgAAAAgAAAAOcGl4aQAAAAABCAAAAAxhdjFDgQAcAAAAADhhdXhDAAAAAHVybjptcGVnOm1wZWdCOmNpY3A6c3lzdGVtczphdXhpbGlhcnk6YWxwaGEAAAAAHmlwbWEAAAAAAAAAAgABBAECgwQAAgQFBocIAAAAYG1kYXQKCDgQo9pAQ0AIMjkVwAMMAASEBQDwXKhSOkb8XyE+u62X9yEvzGK0CywpNegYOP1WbLsKinWaYKf346z8K+z/kbInKGIKBRgQo9pUMgoVwAABIAACaw7h" type="image/avif"><img src="//:0" alt="cover" width="362" height="163" decoding="sync"></picture></div><p>你可以编辑所有值，更改将在下次运行时应用。</p><p>开启 <code>Delete Unused</code> 属性会移除托管文本文件中没有过被<code>ManagedTextProvider</code>和<code>ManagedText</code>源码中引用的条目。</p><h2 id="托管文本加载器" tabindex="-1">托管文本加载器 <a class="header-anchor vp-link" href="#托管文本加载器" aria-label="Permalink to &quot;托管文本加载器&quot;">​</a></h2><p>可以通过 <code>ManagedTextProvider</code> 组件不用代码，将任意Unity物体和托管文本相关联； 在该物体挂载该组件，定义类别（包含该记录的文件名），键值（文本内该记录的名字）并使用 <code>OnValueChanged</code> 事件绑定该值到游戏物体。</p><p>以下是将&quot;MyCustomDocument&quot;文本文件中 &quot;MyCustomText&quot; 的值绑定到Unity的 &quot;Text&quot; 组件的示例：</p><div class="imgit-picture" style="display:flex;" data-imgit-container><picture style="width:100%;"><source srcset="'+E+'" type="image/avif"><source srcset="'+y+'"><img data-imgit-loadable alt="" width="497" height="226" loading="lazy" decoding="async"></picture><picture class="imgit-cover" style="width:100%;margin-left:-100%;"><source srcset="data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUEAAAGobWV0YQAAAAAAAAAvaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAFBpY3R1cmVIYW5kbGVyAAAAAA5waXRtAAAAAAABAAAALGlsb2MAAAAARAAAAgABAAAAAQAAAdAAAAA3AAIAAAABAAACBwAAABMAAABCaWluZgAAAAAAAgAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAGmluZmUCAAAAAAIAAGF2MDFBbHBoYQAAAAAaaXJlZgAAAAAAAAAOYXV4bAACAAEAAQAAANdpcHJwAAAAsWlwY28AAAAUaXNwZQAAAAAAAAAYAAAACwAAABBwaXhpAAAAAAMICAgAAAAMYXYxQ4EgAAAAAAATY29scm5jbHgAAgACAACAAAAAFGlzcGUAAAAAAAAAGAAAAAsAAAAOcGl4aQAAAAABCAAAAAxhdjFDgQAcAAAAADhhdXhDAAAAAHVybjptcGVnOm1wZWdCOmNpY3A6c3lzdGVtczphdXhpbGlhcnk6YWxwaGEAAAAAHmlwbWEAAAAAAAAAAgABBAECgwQAAgQFBocIAAAAUm1kYXQKCDgQ700gIaAEMisVwAwwAASEEQDowt9Ng7LYQo44TU9C2gAHhgxfPxwAludEQHplZRZRvfcYCgUYEO9NKjIKFcAAASAAAmsO4Q==" type="image/avif"><img src="//:0" alt="cover" width="497" height="226" decoding="sync"></picture></div><p><code>ManagedTextProvider</code> 组件用于自定义UI时，文本打字机，选择处理，使用托管文本工具生成时，对应记录会自动生成（这些UI已在配置菜单配置）；其他情况就需要自己手动添加记录了。</p><div class="imgit-picture" style="display:flex;" data-imgit-container><picture style="width:100%;"><source srcset="'+u+'" type="image/avif"><source srcset="'+B+`"><img data-imgit-loadable alt="" width="388" height="83" loading="lazy" decoding="async"></picture><picture class="imgit-cover" style="width:100%;margin-left:-100%;"><source srcset="data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUEAAAGobWV0YQAAAAAAAAAvaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAFBpY3R1cmVIYW5kbGVyAAAAAA5waXRtAAAAAAABAAAALGlsb2MAAAAARAAAAgABAAAAAQAAAdAAAAA3AAIAAAABAAACBwAAABMAAABCaWluZgAAAAAAAgAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAGmluZmUCAAAAAAIAAGF2MDFBbHBoYQAAAAAaaXJlZgAAAAAAAAAOYXV4bAACAAEAAQAAANdpcHJwAAAAsWlwY28AAAAUaXNwZQAAAAAAAAATAAAABAAAABBwaXhpAAAAAAMICAgAAAAMYXYxQ4EgAAAAAAATY29scm5jbHgAAgACAACAAAAAFGlzcGUAAAAAAAAAEwAAAAQAAAAOcGl4aQAAAAABCAAAAAxhdjFDgQAcAAAAADhhdXhDAAAAAHVybjptcGVnOm1wZWdCOmNpY3A6c3lzdGVtczphdXhpbGlhcnk6YWxwaGEAAAAAHmlwbWEAAAAAAAAAAgABBAECgwQAAgQFBocIAAAAUm1kYXQKCDgQZbSAhoAQMisVwAAASIBQ+QYyvqep0BDY4DRioJ7/yG/tVbujPBnBNVJX5IhT6hcXmefyCgUYEGW0qDIKFcAAASAAAmsO4Q==" type="image/avif"><img src="//:0" alt="cover" width="388" height="83" decoding="sync"></picture></div><h2 id="托管文本变量" tabindex="-1">托管文本变量 <a class="header-anchor vp-link" href="#托管文本变量" aria-label="Permalink to &quot;托管文本变量&quot;">​</a></h2><p>托管文本记录也可和源码中的变量绑定。在任意C#代码中的静态字符串（string）字段前添加 <code>ManagedText</code> 标记。该值就会在引擎初始化的时候覆写托管文本中的配置值。</p><p>以下是C#中使用该功能来为文本标签进行赋值的示例：</p><div class="language-csharp vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">csharp</span><pre class="shiki shiki-themes theme-light theme-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">using</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Naninovel</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">using</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> UnityEngine</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">UI</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 继承UI的Text组件Inheriting our class from the Unity&#39;s text component, so we can use it as one.</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">public</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> CustomLabel</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> : </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Text</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    //&quot;CustomLabel.LabelText&quot;的值会和托管文本值关联到下面的值，并会在地区选择改变时更新。</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    [</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ManagedText</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;MyCustomUI&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)] </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// &quot;MyCustomUI&quot; 是保存该文本值的托管文本文件名</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    public</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> static</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> string</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> LabelText</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;Default Value&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">; </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// &quot;Default Value&quot; 为默认值</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    protected</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> override</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> void</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Awake</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        base</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Awake</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        text </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> LabelText; </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 将当前托管文本内的值赋值到该文本对象</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        // 运行时，当地区选择改变时，更新该值</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        Engine.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">GetService</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ILocalizationManager</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;().OnLocaleChanged </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> _</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> text </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> LabelText;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><h2 id="脚本获取托管文本值" tabindex="-1">脚本获取托管文本值 <a class="header-anchor vp-link" href="#脚本获取托管文本值" aria-label="Permalink to &quot;脚本获取托管文本值&quot;">​</a></h2><p>可以直接从naninovel脚本获取托管文本值。当脚本中需要使用部分值，或是做本地化的时候会很方便。</p><p>创建名为“script”的托管文本，为里面的条目添加 <code>T_</code> 或 <code>t_</code> 前缀。现在就可以在脚本表达式中引用该值了；如下为托管文本内容示例：</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes theme-light theme-dark vp-code"><code><span class="line"><span>T_Greeting1: Hey!</span></span>
<span class="line"><span>T_Greeting2: Hello!</span></span>
<span class="line"><span>T_Greeting3: Hi!</span></span></code></pre></div><p>— 你可以在脚本像如下引用:</p><div class="language-nani vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">nani</span><pre class="shiki shiki-themes theme-light theme-dark vp-code"><code><span class="line"><span style="--shiki-light:#257DC8;--shiki-dark:#6CB2ED;">@print</span><span style="--shiki-light:#3ABFB3;--shiki-dark:#62B8C1;"> {Random(T_Greeting1,T_Greeting2,T_Greeting3)}</span></span></code></pre></div><p>当然，&quot;Script&quot; 也可以像其他托管文本一样的方式来做本地化；当用户改变地区设置的时候，文本就会自动从相应的本地化文本中获取值。</p><h2 id="本地化" tabindex="-1">本地化 <a class="header-anchor vp-link" href="#本地化" aria-label="Permalink to &quot;本地化&quot;">​</a></h2><p>托管文本本地化过程类似于naninovel脚本： Managed text localization process resemble the one for naninovel scripts:</p><ol><li><code>Resources/Naninovel/Text</code> 文件夹中生成（创建，编辑）所需的托管文本文档。</li><li>在语言环境文件夹(<code>Resources/Naninovel/Localization/{Locale}</code>，<code>{Locale}</code>是目标语言环境的标记）中运行本地化实用程序。</li><li>托管文本文档的本地化文档将出现在相应的语言环境文件夹中。对它们进行对应语言的添加或编辑翻译。</li></ol><p>要更新托管文本和其对应的本地文件，在<code>Resources/Naninovel/Text</code> 目录运行本地化实用程序，然后选择<code>Resources/Naninovel/Localization/{Locale}</code> 文件夹。他们会尝试保存所有已有的修改（托管文本记录和其翻译），因此你不必每次都重头开始编辑所有内容。</p><p>有关如何使用本地化实用程序的更多信息，请参见<a href="/naninovel-docs/zh/guide/localization" class="vp-link">本地化</a> 。</p><div class="tip custom-block"><p class="custom-block-title">EXAMPLE</p><p>可以参考本地化示例（包含托管文本）<a href="/naninovel-docs/zh/guide/getting-started#演示项目" class="vp-link">演示项目</a>。 如果你在自己的项目中遇到问题，请用做参考。</p></div>`,33),b=[C];function v(G,F,w,x,Q,_){return a(),s("div",null,b)}const I=A(o,[["render",v]]);export{Y as __pageData,I as default};
