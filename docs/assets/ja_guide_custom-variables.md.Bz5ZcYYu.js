import{_ as A,c as s,o as a,f as i,cb as e,cc as t,cd as n,ce as l,cf as p,cg as h}from"./chunks/framework.BG74BkEs.js";const _=JSON.parse('{"title":"カスタム変数","description":"","frontmatter":{},"headers":[],"relativePath":"ja/guide/custom-variables.md","filePath":"ja/guide/custom-variables.md","lastUpdated":1698833889000}'),c={name:"ja/guide/custom-variables.md"},d=e+" 1x",o=t+" 1x",r=n+" 1x",k=l+" 1x",g=p+" 1x",B=h+" 1x",m=i(`<h1 id="カスタム変数" tabindex="-1">カスタム変数 <a class="header-anchor vp-link" href="#カスタム変数" aria-label="Permalink to &quot;カスタム変数&quot;">​</a></h1><p>カスタム変数機能を使用すると、ユーザー指定の変数を作成し、naninovelスクリプトまたは他のシステムの条件付き実行を実行するのに使用できます。たとえばカスタム変数は、プレーヤーが過去に行った決定に基づいて、複数の中から特定のシナリオルートを選択するのに使えます。よく使用される他の例は、プレーヤーのゲーム内での行動に基づくプレーヤー統計画面（スコア、お金、リソースなど）です。</p><p>カスタム変数はnaninovelスクリプトで、 <a href="/ja/api/#set" target="_blank"><code>@set</code></a>コマンドと <a href="/ja/api/#if" target="_blank"><code>@if</code></a> コマンドで作成、変更、使用できます。また <code>ICustomVariableManager</code> <a href="/naninovel-docs/ja/guide/engine-services" class="vp-link">エンジンサービス</a> を使用した C# スクリプトでも可能です。</p><p>たとえば以下のスクリプトコマンドは、選択に基づいて、カスタム変数 <code>score</code> に異なる値を割り当てます:</p><div class="language-nani vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">nani</span><pre class="shiki shiki-themes theme-light theme-dark vp-code"><code><span class="line"><span style="--shiki-light:#257DC8;--shiki-dark:#6CB2ED;">@choice</span><span style="--shiki-light:#9250BF;--shiki-dark:#E2BE7F;"> &quot;I&#39;m humble, one is enough...&quot;</span><span style="--shiki-light:#C642A5;--shiki-dark:#CD9769;"> set:</span><span style="--shiki-light:#9250BF;--shiki-dark:#E2BE7F;">score=1</span></span>
<span class="line"><span style="--shiki-light:#257DC8;--shiki-dark:#6CB2ED;">@choice</span><span style="--shiki-light:#9250BF;--shiki-dark:#E2BE7F;"> &quot;Two, please.&quot;</span><span style="--shiki-light:#C642A5;--shiki-dark:#CD9769;"> set:</span><span style="--shiki-light:#9250BF;--shiki-dark:#E2BE7F;">score=2</span></span>
<span class="line"><span style="--shiki-light:#257DC8;--shiki-dark:#6CB2ED;">@choice</span><span style="--shiki-light:#9250BF;--shiki-dark:#E2BE7F;"> &quot;I&#39;ll take your entire stock!&quot;</span><span style="--shiki-light:#C642A5;--shiki-dark:#CD9769;"> set:</span><span style="--shiki-light:#9250BF;--shiki-dark:#E2BE7F;">score=999</span></span></code></pre></div><p>次のコードは、<code>score</code> 変数の値に基づいてスクリプトの実行を再ルーティングします：</p><div class="language-nani vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">nani</span><pre class="shiki shiki-themes theme-light theme-dark vp-code"><code><span class="line"><span style="--shiki-light:#257DC8;--shiki-dark:#6CB2ED;">@goto</span><span style="--shiki-light:#9250BF;--shiki-dark:#E2BE7F;"> MainRoute</span><span style="--shiki-light:#C642A5;--shiki-dark:#CD9769;"> if:</span><span style="--shiki-light:#9250BF;--shiki-dark:#E2BE7F;">&quot;score &gt; 1 &amp;&amp; score &lt;= 900&quot;</span></span>
<span class="line"><span style="--shiki-light:#257DC8;--shiki-dark:#6CB2ED;">@goto</span><span style="--shiki-light:#9250BF;--shiki-dark:#E2BE7F;"> BadEnd</span><span style="--shiki-light:#C642A5;--shiki-dark:#CD9769;"> if:</span><span style="--shiki-light:#9250BF;--shiki-dark:#E2BE7F;">score&gt;900</span></span></code></pre></div><p>他の例は、APIリファレンスの <a href="/ja/api/#set" target="_blank"><code>@set</code></a> と <a href="/ja/api/#if" target="_blank"><code>@if</code></a> コマンドを参照してください。</p><p>すべてのカスタム変数は自動的にゲームに保存されます。デフォルトでは変数は <strong>ローカルスコープ</strong> に保存されます。つまり、ゲームプレイ中に変数を割り当て、プレーヤーが新しいゲームを開始したり、その変数が割り当てられていない別の保存済みゲームスロットを読み込んだりすると、値は失われます。これはほとんどの変数に便利です。しかし、もし <strong>グローバルスコープ</strong> に変数を保存したい場合は、変数名に <code>G_</code> か <code>g_</code> を付与してください。例: <code>G_FinishedMainRoute</code> または <code>g_total_score</code>。グローバル変数を使用すると、メタ情報や合計情報を示すことができます。たとえば、プレーヤーがルートを終了した回数や、すべてのプレイに基づく合計スコアなどです。</p><p>コンフィグメニュー &quot;Custom Variables&quot; で、事前定義されたカスタム変数（グローバルとローカルの両方）に初期値を設定できます。</p><div class="imgit-picture" style="display:flex;" data-imgit-container><picture style="width:100%;"><source srcset="`+d+'" type="image/avif"><source srcset="'+o+`"><img data-imgit-loadable alt="" width="720" height="355" loading="lazy" decoding="async"></picture><picture class="imgit-cover" style="width:100%;margin-left:-100%;"><source srcset="data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUEAAAGobWV0YQAAAAAAAAAvaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAFBpY3R1cmVIYW5kbGVyAAAAAA5waXRtAAAAAAABAAAALGlsb2MAAAAARAAAAgABAAAAAQAAAdAAAABgAAIAAAABAAACMAAAABQAAABCaWluZgAAAAAAAgAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAGmluZmUCAAAAAAIAAGF2MDFBbHBoYQAAAAAaaXJlZgAAAAAAAAAOYXV4bAACAAEAAQAAANdpcHJwAAAAsWlwY28AAAAUaXNwZQAAAAAAAAAkAAAAEgAAABBwaXhpAAAAAAMICAgAAAAMYXYxQ4EgAAAAAAATY29scm5jbHgAAgACAACAAAAAFGlzcGUAAAAAAAAAJAAAABIAAAAOcGl4aQAAAAABCAAAAAxhdjFDgQAcAAAAADhhdXhDAAAAAHVybjptcGVnOm1wZWdCOmNpY3A6c3lzdGVtczphdXhpbGlhcnk6YWxwaGEAAAAAHmlwbWEAAAAAAAAAAgABBAECgwQAAgQFBocIAAAAfG1kYXQKCDgVI4tICGgBMlQVwAIIYYSBBADrlGfne39gWsi/RF/zflZYNGFKIS10j4Wl61z+l1sAQ4MfOc3Eh7nNRUKaWZEdQaFbEi5nN11DXvnfos846sdCN6D+23vk+AxTl1AKBhgVI4tKgDIKFcAAASAABjTg5g==" type="image/avif"><img src="//:0" alt="cover" width="720" height="355" decoding="sync"></picture></div><p>グローバルな事前定義変数は、最初のアプリケーションの起動時に初期化されますが、ローカル事前定義変数はステートがリセットされるたびに初期化されます。メニューの値フィールドには、raw値文字列ではなく、有効なスクリプト式が必要であることに注意してください。</p><h2 id="変数の挿入" tabindex="-1">変数の挿入 <a class="header-anchor vp-link" href="#変数の挿入" aria-label="Permalink to &quot;変数の挿入&quot;">​</a></h2><p>中括弧を使用して、naninovelスクリプトのパラメーター値にカスタム変数を挿入（インライン化）することができます。</p><p>次のスクリプトは、ユーザーが任意のテキストを入力できる入力フィールドUIを示しています。送信すると、入力したテキストが指定したカスタム変数に割り当てられます。</p><div class="language-nani vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">nani</span><pre class="shiki shiki-themes theme-light theme-dark vp-code"><code><span class="line"><span style="--shiki-light:#ACB5C6;--shiki-dark:#5D6470;">; ユーザーに任意のテキストを入力させ、それをカスタムステート変数 \`name\` に割り当てます。</span></span>
<span class="line"><span style="--shiki-light:#257DC8;--shiki-dark:#6CB2ED;">@input</span><span style="--shiki-light:#9250BF;--shiki-dark:#E2BE7F;"> name</span><span style="--shiki-light:#C642A5;--shiki-dark:#CD9769;"> summary:</span><span style="--shiki-light:#9250BF;--shiki-dark:#E2BE7F;">&quot;Choose your name.&quot;</span></span>
<span class="line"><span style="--shiki-light:#ACB5C6;--shiki-dark:#5D6470;">; ユーザーが入力を送信するまでスクリプトの実行を停止させるため、停止コマンドが必要です</span></span>
<span class="line"><span style="--shiki-light:#257DC8;--shiki-dark:#6CB2ED;">@stop</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#ACB5C6;--shiki-dark:#5D6470;">; これで割り当てられた \`name\` 変数をnaninovelスクリプトに挿入できます。</span></span>
<span class="line"><span style="--shiki-light:#9250BF;--shiki-dark:#E2BE7F;">Archibald:</span><span style="--shiki-light:#4B5871;--shiki-dark:#ACB2BE;"> Greetings, </span><span style="--shiki-light:#3ABFB3;--shiki-dark:#62B8C1;">{name}</span><span style="--shiki-light:#4B5871;--shiki-dark:#ACB2BE;">!</span></span>
<span class="line"><span style="--shiki-light:#9250BF;--shiki-dark:#E2BE7F;">{name}:</span><span style="--shiki-light:#4B5871;--shiki-dark:#ACB2BE;"> Yo!</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#ACB5C6;--shiki-dark:#5D6470;">; または、setや条件式の中で使用することもできます。</span></span>
<span class="line"><span style="--shiki-light:#257DC8;--shiki-dark:#6CB2ED;">@set</span><span style="--shiki-light:#9250BF;--shiki-dark:#E2BE7F;"> score=score+1</span><span style="--shiki-light:#C642A5;--shiki-dark:#CD9769;"> if:</span><span style="--shiki-light:#9250BF;--shiki-dark:#E2BE7F;">name==&quot;Felix&quot;</span></span></code></pre></div><p>使用可能なタイプであれば、カスタム変数を任意のパラメーター値に挿入できます。文字列（テキスト）を整数（数値）パラメータに割り当てることはできません。</p><div class="language-nani vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">nani</span><pre class="shiki shiki-themes theme-light theme-dark vp-code"><code><span class="line"><span style="--shiki-light:#257DC8;--shiki-dark:#6CB2ED;">@set</span><span style="--shiki-light:#9250BF;--shiki-dark:#E2BE7F;"> PlayerName=&quot;Felix&quot;;PlayerYPosition=0.1;PlayerTint=&quot;lightblue&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#ACB5C6;--shiki-dark:#5D6470;">; 以下はエラーになります。\`PlayerTint\` は数値ではないためです。</span></span>
<span class="line"><span style="--shiki-light:#257DC8;--shiki-dark:#6CB2ED;">@char</span><span style="--shiki-light:#3ABFB3;--shiki-dark:#62B8C1;"> {PlayerName}</span><span style="--shiki-light:#C642A5;--shiki-dark:#CD9769;"> pos:</span><span style="--shiki-light:#9250BF;--shiki-dark:#E2BE7F;">50,</span><span style="--shiki-light:#3ABFB3;--shiki-dark:#62B8C1;">{PlayerTint}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#ACB5C6;--shiki-dark:#5D6470;">; ...こちらは問題なく動作するでしょう。</span></span>
<span class="line"><span style="--shiki-light:#257DC8;--shiki-dark:#6CB2ED;">@char</span><span style="--shiki-light:#3ABFB3;--shiki-dark:#62B8C1;"> {PlayerName}</span><span style="--shiki-light:#C642A5;--shiki-dark:#CD9769;"> pos:</span><span style="--shiki-light:#9250BF;--shiki-dark:#E2BE7F;">50,</span><span style="--shiki-light:#3ABFB3;--shiki-dark:#62B8C1;">{PlayerYPosition}</span><span style="--shiki-light:#C642A5;--shiki-dark:#CD9769;"> tint:</span><span style="--shiki-light:#3ABFB3;--shiki-dark:#62B8C1;">{PlayerTint}</span></span></code></pre></div><h2 id="変数トリガー" tabindex="-1">変数トリガー <a class="header-anchor vp-link" href="#変数トリガー" aria-label="Permalink to &quot;変数トリガー&quot;">​</a></h2><p><a href="/naninovel-docs/ja/guide/user-interface#カスタムUI" class="vp-link">カスタムUI</a> や他のシステムを構築する場合、変数の値が変更されたときにイベントを発生（反応）したい場合があります。たとえば、キャラクターの統計画面を作成するとき、変数によってテキストを変更するなどです。このような動作を実装する従来の方法は C# スクリプトを使用することですが、 <code>Custom Variable Trigger</code> コンポーネントを利用することもできます。指定された名前の変数が変更されると、コンポーネントはUnityイベントを呼び出します。テキスト値の更新など、互換性のあるコマンドをこれらのイベントにバインドできます。</p><div class="imgit-picture" style="display:flex;" data-imgit-container><picture style="width:100%;"><source srcset="`+r+'" type="image/avif"><source srcset="'+k+'"><img data-imgit-loadable alt="" width="503" height="275" loading="lazy" decoding="async"></picture><picture class="imgit-cover" style="width:100%;margin-left:-100%;"><source srcset="data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUEAAAGobWV0YQAAAAAAAAAvaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAFBpY3R1cmVIYW5kbGVyAAAAAA5waXRtAAAAAAABAAAALGlsb2MAAAAARAAAAgABAAAAAQAAAdAAAAA8AAIAAAABAAACDAAAABMAAABCaWluZgAAAAAAAgAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAGmluZmUCAAAAAAIAAGF2MDFBbHBoYQAAAAAaaXJlZgAAAAAAAAAOYXV4bAACAAEAAQAAANdpcHJwAAAAsWlwY28AAAAUaXNwZQAAAAAAAAAZAAAADgAAABBwaXhpAAAAAAMICAgAAAAMYXYxQ4EgAAAAAAATY29scm5jbHgAAgACAACAAAAAFGlzcGUAAAAAAAAAGQAAAA4AAAAOcGl4aQAAAAABCAAAAAxhdjFDgQAcAAAAADhhdXhDAAAAAHVybjptcGVnOm1wZWdCOmNpY3A6c3lzdGVtczphdXhpbGlhcnk6YWxwaGEAAAAAHmlwbWEAAAAAAAAAAgABBAECgwQAAgQFBocIAAAAV21kYXQKCDgQ8a0gIaAEMjAVwAQQQQSBBADFYcuko37z8OZzwxJDr0pO8dZbAzxHn8YTuhel+51cE/f3WN0Tu9gKBRgQ8a0qMgoVwAABIAACaw7h" type="image/avif"><img src="//:0" alt="cover" width="503" height="275" decoding="sync"></picture></div><h2 id="変数のデバッグ" tabindex="-1">変数のデバッグ <a class="header-anchor vp-link" href="#変数のデバッグ" aria-label="Permalink to &quot;変数のデバッグ&quot;">​</a></h2><p>ゲームの実行中にすべての既存の変数を表示し、値を変更してデバッグが可能です。</p><p><a href="/naninovel-docs/ja/guide/development-console" class="vp-link">開発コンソール</a> を開いて <code>var</code> コマンドを入力し、変数編集ウィンドウを開きます。</p><div class="imgit-picture" style="display:flex;" data-imgit-container><picture style="width:100%;"><source srcset="'+g+'" type="image/avif"><source srcset="'+B+'"><img data-imgit-loadable alt="" width="720" height="405" loading="lazy" decoding="async"></picture><picture class="imgit-cover" style="width:100%;margin-left:-100%;"><source srcset="data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUEAAAGobWV0YQAAAAAAAAAvaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAFBpY3R1cmVIYW5kbGVyAAAAAA5waXRtAAAAAAABAAAALGlsb2MAAAAARAAAAgABAAAAAQAAAdAAAACzAAIAAAABAAACgwAAABQAAABCaWluZgAAAAAAAgAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAGmluZmUCAAAAAAIAAGF2MDFBbHBoYQAAAAAaaXJlZgAAAAAAAAAOYXV4bAACAAEAAQAAANdpcHJwAAAAsWlwY28AAAAUaXNwZQAAAAAAAAAkAAAAFAAAABBwaXhpAAAAAAMICAgAAAAMYXYxQ4EgAAAAAAATY29scm5jbHgAAgACAACAAAAAFGlzcGUAAAAAAAAAJAAAABQAAAAOcGl4aQAAAAABCAAAAAxhdjFDgQAcAAAAADhhdXhDAAAAAHVybjptcGVnOm1wZWdCOmNpY3A6c3lzdGVtczphdXhpbGlhcnk6YWxwaGEAAAAAHmlwbWEAAAAAAAAAAgABBAECgwQAAgQFBocIAAAAz21kYXQKCDgVI5tICGgBMqYBFcAAAEgQUMaQM4aJjtmCHMdFNlls0VNwGzI3LEXenmVNGNN/5u1khHoi3tzrWcz0dG3ONWZHNO+JGdvL4CkDmzy+c8enoY2+yyCzT3z5kuOHCzMCsUXYGYrmpt2svCJ6QcjqAX1bdd0DC8UzJmDNrIyfxH+sA9AY8adLA9/lkime5h53r8Srbsr53xj/ZyX1CLXx42D/VsdGLtR484WIYoG/QjX3oAoGGBUjm0qAMgoVwAABIAAGNODm" type="image/avif"><img src="//:0" alt="cover" width="720" height="405" decoding="sync"></picture></div><p>リスト内の変数の値を変更すると &quot;SET&quot; ボタンが表示され、クリックすると変更を適用できます。</p><p>変数リストは、ゲームの実行中にカスタム変数が変更されると自動的に更新されます。</p>',27),C=[m];function y(u,E,b,F,v,D){return a(),s("div",null,C)}const Q=A(c,[["render",y]]);export{_ as __pageData,Q as default};
